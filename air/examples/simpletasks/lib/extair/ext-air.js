/*
 * Enhanced ExtJS Adapter for Adobe(r) AIR(r)
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@extjs.com
 * http://www.extjs.com/license
 * 
 * @version 3.2.2
 * [For Use with ExtJS 3.1.0 to ExtJS 3.2.2]
 */
if(Ext){var ua=window.navigator.userAgent.toLowerCase();Ext.isAir2=Ext.isAir&&/adobeair\/2/.test(ua);Ext.isAir15=Ext.isAir&&/adobeair\/1\.5/.test(ua);Ext.isAir1=Ext.isAir&&!Ext.isAir15&&!Ext.isAir2;Ext.isArray=function(a){return a&&typeof a.length=="number"&&typeof a.splice=="function"};Ext.onReady(function(){Ext.getBody().addClass("ext-air").addClass("ext-air"+(Ext.isAir2?"2":(Ext.isAir15?"15":"1")))})}if(air){Ext.applyIf(air,{StageDisplayState:window.runtime.flash.display.StageDisplayState,EncryptionKeyGenerator:null});try{Ext.apply(air,{NativeProcessStartEvent:window.runtime.flash.events.NativeProcessStartEvent,EncryptionKeyGenerator:window.runtime.com.adobe.data.encryption.EncryptionKeyGenerator})}catch(e){}}Ext.ns("Ext.air");Ext.apply(Ext.EventObjectImpl.prototype,{hasFormat:function(d){if(this.browserEvent.dataTransfer){for(var b=0,a=this.browserEvent.dataTransfer.types.length;b<a;b++){if(this.browserEvent.dataTransfer.types[b]==d){return true}}}return false},getData:function(a){return this.browserEvent.dataTransfer.getData(a)}});Ext.apply(Date,{precompileFormats:function(b){var g=b.split("|");for(var d=0,a=g.length;d<a;d++){Date.createFormat(g[d]);Date.createParser(g[d])}}});Date.precompileFormats("D n/j/Y|n/j/Y|j/n/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|YmdHis|m/d/Y|m/d/y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|Y-m-d H:i:s|d/m/y|d/m/Y|d-m-y|d-m-Y|d/m|d-m|dm|dmy|dmY|l|D m/d|D m/d/Y|F d, Y|l, F d, Y|H:i:s|g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A|y|Y-m|m|D|Y|F|M|F Y|M Y|M y|Y/m/d H:i|m/y|m Y|m/d/Y H:i|YmdHi|c");Date.precompileFormats(Ext.form.TimeField.prototype.initDateFormat+" "+(Ext.form.TimeField.prototype.format+"|"+Ext.form.TimeField.prototype.altFormats).split("|").join("|"+Ext.form.TimeField.prototype.initDateFormat+" "));Date.precompileFormats(Ext.form.TimeField.prototype.format+"|"+Ext.form.TimeField.prototype.altFormats);Date.precompileFormats((Ext.form.DateField.prototype.format+"|"+Ext.form.DateField.prototype.altFormats).split("|").join(" "+Ext.form.DateField.prototype.initTimeFormat+"|")+" "+Ext.form.DateField.prototype.initTimeFormat);Date.precompileFormats([Ext.form.TimeField.prototype.format,Ext.form.TimeField.prototype.altFormats,Ext.form.DateField.prototype.format,Ext.form.DateField.prototype.altFormats,Ext.grid.DateColumn.prototype.format,Ext.grid.PropertyColumnModel.prototype.dateFormat,Ext.DatePicker.prototype.format].join("|"));Ext.DomQuery=function(){var w={},u={},t={},C=/\S/,m=/^\s+|\s+$/g,A=/\{(\d+)\}/g,o=/^(\s?[\/>+~]\s?|\s|$)/,p=/^(#)?([\w-\*]+)/,r=/(\d*)n\+?(\d*)/,i=/\D/,D=30803;batch=30803;function l(G,E){var F=0,H=G.firstChild;while(H){if(H.nodeType==1){if(++F==E){return H}}H=H.nextSibling}return null}function y(E){while((E=E.nextSibling)&&E.nodeType!=1){}return E}function x(E){while((E=E.previousSibling)&&E.nodeType!=1){}return E}function h(F){var H=F.firstChild,G=-1,E;while(H){E=H.nextSibling;if(H.nodeType==3&&!C.test(H.nodeValue)){F.removeChild(H)}else{H.nodeIndex=++G}H=E}return this}function f(J,G){if(!G){return J}var E=[],F=-1;for(var I=0,H;H=J[I];I++){if((" "+H.className+" ").indexOf(G)!=-1){E[++F]=H}}return E}function v(F,E){if(!F.tagName&&typeof F.length!="undefined"){F=F[0]}if(!F){return null}if(E=="for"){return F.htmlFor}if(E=="class"||E=="className"){return F.className}return F.getAttribute(E)||F[E]}function d(M,K,G){var R=[],O=-1,L;if(!M){return R}G=G||"*";if(typeof M.getElementsByTagName!="undefined"){M=[M]}if(!K){for(var I=0,E;E=M[I];I++){L=E.getElementsByTagName(G);for(var H=0,Q;Q=L[H];H++){R[++O]=Q}}}else{if(K=="/"||K==">"){var J=G.toUpperCase();for(var I=0,E,N;E=M[I];I++){N=E.childNodes;for(var H=0,P;P=N[H];H++){if(P.nodeName==J||P.nodeName==G||G=="*"){R[++O]=P}}}}else{if(K=="+"){var J=G.toUpperCase();for(var I=0,F;F=M[I];I++){while((F=F.nextSibling)&&F.nodeType!=1){}if(F&&(F.nodeName==J||F.nodeName==G||G=="*")){R[++O]=F}}}else{if(K=="~"){var J=G.toUpperCase();for(var I=0,F;F=M[I];I++){while((F=F.nextSibling)){if(F.nodeName==J||F.nodeName==G||G=="*"){R[++O]=F}}}}}}}return R}function k(G,E){if(E.slice){return G.concat(E)}for(var H=0,F=E.length;H<F;H++){G[G.length]=E[H]}return G}function B(J,I){if(J.tagName||J==document){J=[J]}if(!I){return J}var E=[],F=-1;I=I.toLowerCase();for(var H=0,G;G=J[H];H++){if(G.nodeType==1&&G.tagName.toLowerCase()==I){E[++F]=G}}return E}function j(I,J){if(I.tagName||I==document){I=[I]}if(!J){return I}var E=[],F=-1;for(var H=0,G;G=I[H];H++){if(G&&G.id==J){E[++F]=G;return E}}return E}function b(H,I,O,G,E){var Q=[],M=-1,N=E=="{",K=Ext.DomQuery.operators[G],L,J;for(var F=0,P;P=H[F];F++){if(P.nodeType!=1){continue}J=P.innerHTML;if(J!==null&&J!==undefined){if(N){L=Ext.DomQuery.getStyle(P,I)}else{if(I=="class"||I=="className"){L=P.className}else{if(I=="for"){L=P.htmlFor}else{if(I=="href"){L=P.getAttribute("href",2)}else{L=P.getAttribute(I)}}}}}else{L=P.getAttribute(I)}if((K&&K(L,O))||(!K&&L)){Q[++M]=P}}return Q}function z(F,E,G){return Ext.DomQuery.pseudos[E](F,G)}function g(H){if(!H){return[]}var I=H.length,K,G,E=H,M,L=-1;if(!I||typeof H.nodeType!="undefined"||I==1){return H}var J=++D;H[0]._nodup=J;for(G=1;K=H[G];G++){if(K._nodup!=J){K._nodup=J}else{E=[];for(var F=0;F<G;F++){E[++L]=H[F]}for(F=G+1;M=H[F];F++){if(M._nodup!=J){M._nodup=J;E[++L]=M}}return E}}return E}function n(I,H){var F=I.length,K=++D,J=[];if(!F){return H}for(var G=0;G<F;G++){I[G]._qdiff=K}for(var G=0,E=H.length;G<E;G++){if(H[G]._qdiff!=K){J[J.length]=H[G]}}return J}function a(F,H,E,I){if(F==E){var G=E.ownerDocument||E;return G.getElementById(I)}F=d(F,H,"*");return j(F,I)}function q(R,N,L){L=L||"select";var F=N||document,K,P,H=Ext.DomQuery.matchers,M=H.length,O;lmode=R.match(o);++batch;if(lmode&&lmode[1]){K=lmode[1].replace(m,"");R=R.replace(lmode[1],"")}while(R.substr(0,1)=="/"){R=R.substr(1)}while(R&&P!=R){P=R;var J=R.match(p);if(L=="select"){if(J){if(J[1]=="#"){F=a(F,K,N,J[2])}else{F=d(F,K,J[2])}R=R.replace(J[0],"")}else{if(R.substr(0,1)!="@"){F=d(F,K,"*")}}}else{if(J){if(J[1]=="#"){F=j(F,J[2])}else{F=B(F,J[2])}R=R.replace(J[0],"")}}while(!(O=R.match(o))){var E=false;for(var I=0;I<M;I++){var Q=H[I];var G=R.match(Q.re);if(G){switch(I){case 0:F=f(F," "+G[1]+" ");break;case 1:F=z(F,G[1],G[2]);break;case 2:F=b(F,G[2],G[4],G[3],G[1]);break;case 3:F=j(F,G[1]);break;case 4:return{firstChild:{nodeValue:v(F,G[1])}}}R=R.replace(G[0],"");E=true;break}}if(!E){throw'Error parsing selector, parsing failed at "'+R+'"'}}if(O[1]){K=O[1].replace(m,"");R=R.replace(O[1],"")}}return g(F)}return{getStyle:function(F,E){return Ext.fly(F).getStyle(E)},compile:function(F,E){return function(G){return q(F,G,E)}},jsSelect:function(M,J,I){J=J||document;if(typeof J=="string"){J=document.getElementById(J)}var L=M.split(","),F=[];for(var G=0,H=L.length;G<H;G++){var E=L[G].replace(m,"");if(!w[E]){w[E]=Ext.DomQuery.compile(E);if(!w[E]){throw E+" is not a valid selector"}}var K=w[E](J);if(K&&K!=document){F=F.concat(K)}}if(L.length>1){return g(F)}return F},isXml:function(E){var F=(E?E.ownerDocument||E:0).documentElement;return F?F.nodeName!=="HTML":false},select:document.querySelectorAll?function(I,E,H){E=E||document;if(!Ext.DomQuery.isXml(E)){try{var G=E.querySelectorAll(I);return Ext.toArray(G)}catch(F){}}return Ext.DomQuery.jsSelect.call(this,I,E,H)}:function(G,E,F){return Ext.DomQuery.jsSelect.call(this,G,E,F)},selectNode:function(F,E){return Ext.DomQuery.select(F,E)[0]},selectValue:function(H,F,E){H=H.replace(m,"");if(!t[H]){t[H]=Ext.DomQuery.compile(H,"select")}var I=t[H](F),G;I=I[0]?I[0]:I;if(typeof I.normalize=="function"){I.normalize()}G=(I&&I.firstChild?I.firstChild.nodeValue:null);return((G===null||G===undefined||G==="")?E:G)},selectNumber:function(H,F,E){var G=Ext.DomQuery.selectValue(H,F,E||0);return parseFloat(G)},is:function(H,G){if(typeof H=="string"){H=document.getElementById(H)}var F=Ext.isArray(H),E=Ext.DomQuery.filter(F?H:[H],G);return F?(E.length==H.length):(E.length>0)},filter:function(G,F,H){F=F.replace(m,"");if(!u[F]){u[F]=Ext.DomQuery.compile(F,"simple")}var E=u[F](G);return H?n(E,G):E},matchers:[{re:/^\.([\w-]+)/,select:'n = byClassName(n, " {1} ");'},{re:/^\:([\w-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w-]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(E,F){return E==F},"!=":function(E,F){return E!=F},"^=":function(E,F){return E&&E.substr(0,F.length)==F},"$=":function(E,F){return E&&E.substr(E.length-F.length)==F},"*=":function(E,F){return E&&E.indexOf(F)!==-1},"%=":function(E,F){return(E%F)==0},"|=":function(E,F){return E&&(E==F||E.substr(0,F.length+1)==F+"-")},"~=":function(E,F){return E&&(" "+E+" ").indexOf(" "+F+" ")!=-1}},pseudos:{"first-child":function(J){var H=[],E=-1,I;for(var G=0,F;F=I=J[G];G++){while((I=I.previousSibling)&&I.nodeType!=1){}if(!I){H[++E]=F}}return H},"last-child":function(J){var H=[],E=-1,I;for(var G=0,F;F=I=J[G];G++){while((I=I.nextSibling)&&I.nodeType!=1){}if(!I){H[++E]=F}}return H},"nth-child":function(M,O){var E=[],P=-1,H=r.exec(O=="even"&&"2n"||O=="odd"&&"2n+1"||!i.test(O)&&"n+"+O||O),L=(H[1]||1)-0,I=H[2]-0;for(var K=0,F;F=M[K];K++){var G=F.parentNode;if(batch!=G._batch){var J=0;for(var N=G.firstChild;N;N=N.nextSibling){if(N.nodeType==1){N.nodeIndex=++J}}G._batch=batch}if(L==1){if(I==0||F.nodeIndex==I){E[++P]=F}}else{if((F.nodeIndex+I)%L==0){E[++P]=F}}}return E},"only-child":function(I){var H=[],E=-1;for(var G=0,F;F=I[G];G++){if(!x(F)&&!y(F)){H[++E]=F}}return H},empty:function(J){var E=[],L=-1;for(var H=0,M;M=J[H];H++){var F=M.childNodes,G=0,K,I=true;while(K=F[G]){++G;if(K.nodeType==1||K.nodeType==3){I=false;break}}if(I){E[++L]=M}}return E},contains:function(J,F){var I=[],E=-1;for(var H=0,G;G=J[H];H++){if((G.textContent||G.innerText||"").indexOf(F)!=-1){I[++E]=G}}return I},nodeValue:function(J,F){var I=[],E=-1;for(var H=0,G;G=J[H];H++){if(G.firstChild&&G.firstChild.nodeValue==F){I[++E]=G}}return I},checked:function(I){var H=[],E=-1;for(var G=0,F;F=I[G];G++){if(F.checked==true){H[++E]=F}}return H},not:function(F,E){return Ext.DomQuery.filter(F,E,true)},any:function(H,J){var L=J.split("|"),E=[],I=-1,K;for(var G=0,M;M=H[G];G++){for(var F=0;K=L[F];F++){if(Ext.DomQuery.is(M,K)){E[++I]=M;break}}}return E},odd:function(E){return this["nth-child"](E,"odd")},even:function(E){return this["nth-child"](E,"even")},nth:function(F,E){return F[E-1]||[]},first:function(E){return E[0]||[]},last:function(E){return E[E.length-1]||[]},has:function(K,H){var I=Ext.DomQuery.select,J=[],E=-1;for(var G=0,F;F=K[G];G++){if(I(H,F).length>0){J[++E]=F}}return J},next:function(L,H){var J=Ext.DomQuery.is,I=[],E=-1;for(var G=0,F;F=L[G];G++){var K=y(F);if(K&&J(K,H)){I[++E]=F}}return I},prev:function(L,H){var J=Ext.DomQuery.is,I=[],E=-1;for(var G=0,F;F=L[G];G++){var K=x(F);if(K&&J(K,H)){I[++E]=F}}return I}}}}();Ext.query=Ext.DomQuery.select;Ext.History=(function(){var b=[],a=-1;return{init:Ext.emptyFn,events:{},add:function(d,f){if(f!==false){if(this.getToken()==d){return}}a++;b.splice(a,b.length-a,d);a=b.length-1;this.fireEvent("add",d)},clear:function(){b=[];a=-1;this.fireEvent("clear")},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(d){var f=(a+d).constrain(-1,b.length-1);if(f!=a){a=f;this.fireEvent("change",this.getToken())}},getToken:function(){return a>-1?b[a]:null}}})();Ext.apply(Ext.History,new Ext.util.Observable());Ext.History.addEvents("add","change","clear");Ext.Template.prototype.compile=function(){var h=Ext.util.Format;var b=this.disableFormats!==true;var j=0;var a=[];var d=this;var g=function(l,k,t,r,o,v){if(j!=o){var n={type:1,value:v.substr(j,o-j)};a.push(n)}j=o+l.length;if(t&&b){if(r){var u=/^\s*['"](.*)["']\s*$/;r=r.split(/,(?=(?:[^"]*"[^"]*")*(?![^"]*"))/);for(var p=0,q=r.length;p<q;p++){r[p]=r[p].replace(u,"$1")}r=[""].concat(r)}else{r=[""]}if(t.substr(0,5)!="this."){var n={type:3,value:k,format:h[t],args:r,scope:h};a.push(n)}else{var n={type:3,value:k,format:d[t.substr(5)],args:r,scope:d};a.push(n)}}else{var n={type:2,value:k};a.push(n)}return l};var f=this.html.replace(this.re,g);if(j!=(f.length-1)){var i={type:1,value:f.substr(j,f.length-j)};a.push(i)}this.compiled=function(l){function k(m){switch(m.type){case 1:return m.value;case 2:return(l[m.value]?l[m.value]:"");default:m.args[0]=l[m.value];return m.format.apply(m.scope,m.args)}}return a.map(k).join("")};return this};Ext.apply(Ext.util.Format,{bool:function(d,a,b,f){if(d===undefined){return f}if(!d||d==="false"){return b}return a}});Ext.ColorPalette.prototype.tpl=new Ext.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');Ext.form.ComboBox.prototype.tpl=new Ext.XTemplate('<tpl for="records"><div class="x-combo-list-item">{[this.getDisplayField(values, parent.combo)]}</div></tpl>',{getDisplayField:function(a,b){return Ext.value(a[b.displayField||b.valueField],"&#160;")}});Ext.override(Ext.form.ComboBox,{initList:function(){if(!this.list){var a="x-combo-list",f=Ext.getDom(this.getListParent()||Ext.getBody()),b=parseInt(Ext.fly(f).getStyle("z-index"),10);if(this.ownerCt&&!b){this.findParentBy(function(g){b=parseInt(g.getPositionEl().getStyle("z-index"),10);return !!b})}this.list=new Ext.Layer({parentEl:f,shadow:this.shadow,cls:[a,this.listClass].join(" "),constrain:false,zindex:(b||12000)+5});var d=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setSize(d,0);this.list.swallowEvent("mousewheel");this.assetHeight=0;if(this.syncFont!==false){this.list.setStyle("font-size",this.el.getStyle("font-size"))}if(this.title){this.header=this.list.createChild({cls:a+"-hd",html:this.title});this.assetHeight+=this.header.getHeight()}this.innerList=this.list.createChild({cls:a+"-inner"});this.mon(this.innerList,"mouseover",this.onViewOver,this);this.mon(this.innerList,"mousemove",this.onViewMove,this);this.innerList.setWidth(d-this.list.getFrameWidth("lr"));if(this.pageSize){this.footer=this.list.createChild({cls:a+"-ft"});this.pageTb=new Ext.PagingToolbar({store:this.store,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight()}this.view=new Ext.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:true,selectedClass:this.selectedClass,itemSelector:this.itemSelector||"."+a+"-item",emptyText:this.listEmptyText,deferEmptyText:false,collectData:(this.tpl==Ext.form.ComboBox.prototype.tpl)?(function(){var g=Ext.DataView.prototype.collectData.apply(this.view,arguments);return{records:g,combo:this}}).createDelegate(this):Ext.DataView.prototype.collectData});this.mon(this.view,{containerclick:this.onViewClick,click:this.onViewClick,scope:this});this.bindStore(this.store,true);if(this.resizable){this.resizer=new Ext.Resizable(this.list,{pinned:true,handles:"se"});this.mon(this.resizer,"resize",function(j,g,i){this.maxHeight=i-this.handleHeight-this.list.getFrameWidth("tb")-this.assetHeight;this.listWidth=g;this.innerList.setWidth(g-this.list.getFrameWidth("lr"));this.restrictHeight()},this);this[this.pageSize?"footer":"innerList"].setStyle("margin-bottom",this.handleHeight+"px")}}},getParams:function(b){var d={},f=this.store.paramNames,a=this.store.baseParams.clause||this.store.baseParams.where;if(this.pageSize){d[f.start]=0,d[f.limit]=this.pageSize}if(a){a=a.replace(/^\s*WHERE\s*/,"");a=" WHERE ("+a+") AND "}else{a=" WHERE "}d.where=a+this.displayField+" LIKE ? || '%'";d.args=this.store.baseParams.args||[];d.args.push(b);return d}});Ext.grid.GroupingView.prototype.startGroup=new Ext.XTemplate('<div id="{groupId}" class="x-grid-group {cls}">','<div id="{groupId}-hd" class="x-grid-group-hd" style="{style}"><div class="x-grid-group-title">{groupTextTpl}</div></div>','<div id="{groupId}-bd" class="x-grid-group-body">');Ext.grid.GroupingView.prototype.groupTextTpl=new Ext.XTemplate("{text}");Ext.override(Ext.grid.GroupingView,{doGroupStart:function(a,f,b,h,d){a[a.length]=this.startGroup.apply(Ext.apply({groupTextTpl:this.groupTextTpl.apply(f)},f))}});Ext.layout.MenuLayout.prototype.itemTpl=new Ext.XTemplate('<li id="{itemId}" class="{itemCls}">','<tpl if="needsIcon">','<img src="{icon}" class="{iconCls}">',"</tpl>","</li>");Ext.list.Column=Ext.extend(Object,{isColumn:true,align:"left",header:"",width:null,cls:"",constructor:function(a){if(!a.tpl){a.tpl=new Ext.Template("{"+a.dataIndex+"}")}else{if(Ext.isString(a.tpl)){a.tpl=new Ext.Template(a.tpl)}}Ext.apply(this,a)}});Ext.reg("lvcolumn",Ext.list.Column);Ext.list.NumberColumn=Ext.extend(Ext.list.Column,{format:"0,000.00",constructor:function(a){a.tpl=a.tpl||new Ext.Template("{"+a.dataIndex+':number("'+(a.format||this.format)+'")}');Ext.list.NumberColumn.superclass.constructor.call(this,a)}});Ext.reg("lvnumbercolumn",Ext.list.NumberColumn);Ext.list.DateColumn=Ext.extend(Ext.list.Column,{format:"m/d/Y",constructor:function(a){a.tpl=a.tpl||new Ext.Template("{"+a.dataIndex+':date("'+(a.format||this.format)+'")}');Ext.list.DateColumn.superclass.constructor.call(this,a)}});Ext.reg("lvdatecolumn",Ext.list.DateColumn);Ext.list.BooleanColumn=Ext.extend(Ext.list.Column,{trueText:"true",falseText:"false",undefinedText:"&#160;",constructor:function(a){a.tpl=a.tpl||new Ext.Template("{"+a.dataIndex+':bool("'+(a.trueText||this.trueText)+'","'+(a.falseText||this.falseText)+'","'+(a.undefinedText||this.undefinedText)+'")}');Ext.list.BooleanColumn.superclass.constructor.call(this,a)}});Ext.reg("lvbooleancolumn",Ext.list.BooleanColumn);Ext.list.ListView.prototype.internalTpl=new Ext.XTemplate('<div class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{[values.width*100]}%;text-align:{align};"><em unselectable="on" id="{parent.id}-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>");Ext.list.ListView.prototype.tpl=new Ext.XTemplate('<tpl for="rows">',"<dl>",'<tpl for="parent.columns">','<dt style="width:{[values.width*100]}%;text-align:{align};"><em unselectable="on"','<tpl if="cls"> class="{cls}"</tpl>',">{[values.tpl.apply(parent)]}","</em></dt>","</tpl>",'<div class="x-clear"></div>',"</dl>","</tpl>");Ext.override(Ext.list.ListView,{collectData:function(){var a=Ext.list.ListView.superclass.collectData.apply(this,arguments);return{columns:this.columns,rows:a,id:this.id}}});Ext.menu.Item.prototype.itemTpl=new Ext.XTemplate('<a id="{id}" class="{cls}" hidefocus="true" unselectable="on" href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>",">",'<img src="{icon}" class="x-menu-item-icon {iconCls}">','<span class="x-menu-item-text">{text}</span>',"</a>");Ext.override(Ext.tree.TreePanel,{initEvents:Ext.tree.TreePanel.prototype.initEvents.createSequence(function(){this.on("resize",this.setRootCtWidth,this);this.on("collapsenode",this.setRootCtWidth,this);this.on("expandnode",this.setRootCtWidth,this)}),setRootCtWidth:function(){var b=this.getTreeEl().child(".x-tree-root-ct");b.applyStyles({width:"auto"});var a=b.getWidth();if(a<this.getEl().getWidth()){b.applyStyles({width:"100%"});if(b.getWidth()<a){b.applyStyles({width:"auto"})}}}});Ext.override(Ext.form.FieldSet,{onRender:Ext.form.FieldSet.prototype.onRender.createSequence(function(){if(this.checkbox&&!this.collapsed){this.checkbox.dom.setAttribute("checked","checked")}}),onCollapse:function(){if(this.checkbox){this.checkbox.dom.removeAttribute("checked")}Ext.form.FieldSet.superclass.onCollapse.apply(this,arguments)},onExpand:function(){if(this.checkbox){this.checkbox.dom.setAttribute("checked","checked")}Ext.form.FieldSet.superclass.onExpand.apply(this,arguments)}});(function(){var a=new Ext.XTemplate('<tpl for="."><div class="x-combo-list-item" style="font-family: {text}">{text}</div></tpl>');Ext.override(Ext.form.HtmlEditor,{createToolbar:Ext.form.HtmlEditor.prototype.createToolbar.createSequence(function(){if(this.enableFont&&!Ext.isSafari2){this.tb.get(0).hide();var b=this.tb.insert(0,this.createFontCombo());b.on("select",function(g,f,d){this.relayCmd("fontname",this.fontFamilies[d]);this.deferFocus()},this);this.tb.doLayout()}}),createFontCombo:function(){var b=[];Ext.each(this.fontFamilies,function(d){b.push(d.toLowerCase())});return new Ext.form.ComboBox({store:new Ext.data.ArrayStore({autoDestroy:true,idIndex:0,data:Ext.zip(b,this.fontFamilies),fields:["value","text"]}),triggerAction:"all",mode:"local",editable:false,forceSelection:true,autoWidth:true,value:this.defaultFont,tpl:a,valueField:"value",displayField:"text"})}})})();Ext.state.FileProvider=function(a){Ext.state.FileProvider.superclass.constructor.call(this);Ext.apply(this,a);this.state=this.readState();air.NativeApplication.nativeApplication.addEventListener(air.Event.EXITING,this.saveState.createDelegate(this))};Ext.extend(Ext.state.FileProvider,Ext.state.Provider,{file:"extstate.json",defaultState:{},readState:function(){var b=air.File.applicationStorageDirectory.resolvePath(this.file),a;if(b.exists){var d=new air.FileStream();d.open(b,air.FileMode.READ);a=Ext.decode(d.readUTFBytes(d.bytesAvailable));d.close()}return Ext.apply({},a||{},this.defaultState||{})},saveState:function(){var a=air.File.applicationStorageDirectory.resolvePath(this.file);var b=new air.FileStream();b.open(a,air.FileMode.WRITE);b.writeUTFBytes(Ext.encode(this.state));b.close()}});Ext.air.FileProvider=Ext.state.FileProvider;Ext.data.DB=function(a){this.addEvents("open","error","close");Ext.apply(this,a);Ext.data.DB.superclass.constructor.call(this)};Ext.extend(Ext.data.DB,Ext.util.Observable,{maxResults:-1,openState:false,open:Ext.emptyFn,close:Ext.emptyFn,exec:Ext.emptyFn,execBy:Ext.emptyFn,query:Ext.emptyFn,queryBy:Ext.emptyFn,createTable:Ext.emptyFn,isOpen:function(){return this.openState},getTable:function(a,b){return new Ext.data.Table(this,a,b)}});Ext.data.DB.getInstance=function(a){return new Ext.data.SQLiteDB(a)};Ext.data.SQLiteDB=function(a){a=a||{};this.addEvents("sqlresult","sqlerror");Ext.data.SQLiteDB.superclass.constructor.call(this,a);this.conn=new air.SQLConnection();if(a.dbFile){this.open(a.dbFile)}};Ext.extend(Ext.data.SQLiteDB,Ext.data.DB,{mode:air.SQLMode.UPDATE,dateFormat:"Y-m-d H:i:s",encryptionKey:null,pageSize:1024,autoCompact:false,open:function(h){var g=Ext.isString(h)?air.File.applicationDirectory.resolvePath(h):h,b=null;if(this.encryptionKey&&!Ext.isEmpty(air.EncryptionKeyGenerator)){if(Ext.isString(this.encryptionKey)){var a=new air.EncryptionKeyGenerator();if(a.validateStrongPassword(this.encryptionKey)){b=a.getEncryptionKey(g,this.encryptionKey)}}else{if(typeof this.encryptionKey=="object"&&this.encryptionKey.bytesAvailable===0&&this.encryptionKey.length===16){b=this.encryptionKey}}}this.openState=false;var d=(function(){this.openState=true;this.fireEvent("open",this)}).createDelegate(this),f=(function(i){this.fireEvent("error",this,i)}).createDelegate(this);this.conn.openAsync(g,this.mode,new air.Responder(d,f),this.autoCompact,this.pageSize,b)},close:function(){this.conn.addEventListener(air.SQLEvent.CLOSE,(function(a){this.openState=false;this.fireEvent("close",this)}).createDelegate(this));this.conn.close()},createCallback:function(b,d,g,a){var f=this;return function(i){var k=!i.error,h=d.getResult(),j={records:f.readResults(h),insertId:h?h.lastInsertRowID:null,affectedRows:h?h.rowsAffected:null,error:i.error};if(Ext.isFunction(g)){g.call(a||f,b,k,j,d,f)}if(k){f.fireEvent("sqlresult",f,j.records,j.insertId,j.affectedRows,d)}else{f.fireEvent("sqlerror",f,j.error,d)}}},createStatement:function(d,g,b){var f=new air.SQLStatement();f.sqlConnection=this.conn;var a=this.createCallback(d,f,g,b);f.addEventListener(air.SQLEvent.RESULT,a);f.addEventListener(air.SQLErrorEvent.ERROR,a);return f},exec:function(b,d,a){return this.execBy(b,null,d,a)},execBy:function(f,a,g,b){var d=this.createStatement("exec",g,b);d.text=f;this.addParams(d,a);d.execute();return d},query:function(b,d,a){return this.queryBy(b,null,d,a)},queryBy:function(f,a,g,b){var d=this.createStatement("query",g,b);d.text=f;this.addParams(d,a);d.execute(this.maxResults);return d},addParams:function(f,b){if(!b){return}for(var d in b){if(b.hasOwnProperty(d)){if(!isNaN(d)){var a=b[d];if(Ext.isDate(a)){a=a.format(this.dateFormat)}f.parameters[parseInt(d)]=a}else{f.parameters[":"+d]=b[d]}}}return f},readResults:function(b){var f=[];if(b&&b.data){var a=b.data.length;for(var d=0;d<a;d++){f[f.length]=b.data[d]}}return f},createTable:function(a){var p=a.name,q=a.key,j=a.fields,b=[];if(!Ext.isArray(j)){j=j.items}for(var h=0,l=j.length;h<l;h++){var k=j[h],g=s=k.mapping?k.mapping:k.name,n=k.defaultValue,r=Ext.isObject(k.type)?k.type.type:k.type;switch(r){case"bool":case"boolean":if(n==="false"){n=false}case"int":case"integer":s+=" INTEGER";break;case"float":s+=" REAL";break;default:s+=" TEXT";break}if(k.allowNull===false||g==q){s+=" NOT NULL"}if(!Ext.isEmpty(n)||(n===""&&r=="string")){s+=" DEFAULT ";if(Ext.isString(n)){s+="'"+n.split("'").join("''")+"'"}else{if(Ext.isBoolean(n)){s+=(!n)?"0":"1"}else{s+=n}}}if(g==q){s+=" PRIMARY KEY";if(k.autoIncrement===true&&(r=="int"||r=="integer")){s+=" AUTOINCREMENT"}}if(k.unique===true){s+=" UNIQUE"}b[b.length]=s}var u=["CREATE TABLE IF NOT EXISTS ",p," (",b.join(","),")"].join("");this.exec(u)}});Ext.data.Table=function(d,a,b){this.conn=d;this.name=a;this.keyName=b};Ext.data.Table.prototype={select:function(b,d,a){return this.selectBy(b,null,d,a)},selectBy:function(d,a,g,b){var f="SELECT * FROM "+this.name;if(d){f+=" "+d}a=a||[];return this.conn.queryBy(f,a,g,b)},insert:function(i,k,g){var h="INSERT INTO "+this.name+" ";var b=[],j=[],d=[];for(var f in i){if(i.hasOwnProperty(f)){b[b.length]=f;j[j.length]="?";d[d.length]=i[f]}}h=[h,"(",b.join(","),") VALUES (",j.join(","),")"].join("");return this.conn.execBy(h,d,k,g)},update:function(d,f,a){var b=this.keyName+" = ?";return this.updateBy(d,b,[d[this.keyName]],f,a)},updateBy:function(b,g,f,j,k){var l="UPDATE "+this.name+" SET ";var d=[],h=[];for(var i in b){if(b.hasOwnProperty(i)){d[d.length]=i+" = ?";h[h.length]=b[i]}}for(var i in f){if(f.hasOwnProperty(i)){h[h.length]=f[i]}}l=[l,d.join(",")," WHERE ",g].join("");return this.conn.execBy(l,h,j,k)},remove:function(b,d,a){this.removeBy(b,null,d,a)},removeBy:function(d,a,g,b){var f="DELETE FROM "+this.name;if(d){f+=" WHERE "+d}a=a||{};this.conn.execBy(f,a,g,b)}};Ext.data.SQLiteProxy=function(a){a=a||{};Ext.apply(a,{restful:false,url:undefined,api:Ext.copyTo({read:true,create:true,update:true,destroy:true},a.api||{},"read,create,update,destroy")});Ext.data.SQLiteProxy.superclass.constructor.call(this,a);if(!a.conn||a.dbFile){this.conn=new Ext.data.SQLiteDB({dbFile:a.dbFile})}else{this.conn=a.conn}};Ext.extend(Ext.data.SQLiteProxy,Ext.data.DataProxy,{doRequest:function(r,n,y,b,k,l,h){if(!this.api[r]){return}if(!this.conn.isOpen()){this.conn.on("open",function(){this.doRequest.call(this,r,n,y,b,k,l,h)},this,{single:true});return}n=(Ext.isArray(n))?n:[n];this.dataStack=[];n.reverse();switch(r){case Ext.data.Api.actions.create:case Ext.data.Api.actions.update:this.recordCounter=0;var f=this.processNextRow.createDelegate(this,[r,n,b,k,l,h]),m=this.handleError.createDelegate(this,[r,null,null,null,h,k,l]);this.inTransaction=this.conn.conn.inTransaction;this.conn.conn[this.inTransaction?"setSavepoint":"begin"](null,new air.Responder(f,m));break;case Ext.data.Api.actions.destroy:var d=l.table.keyName,t,u;for(t=0,u=n.length;t<u;t++){this.recordCounter=n.length;l.table.removeBy(d+" = ?",[n[t].id],this.createCallback(r,n,{},b,k,l,h),this)}break;default:var w=y[l.paramNames.sort],q=y[l.paramNames.dir],j=y[l.paramNames.start],v=y[l.paramNames.limit],o=y.groupBy,p=y.groupDir,x=y.clause||y.where||"",g=y.args||[],a={};if(o||w){x+=" ORDER BY ";if(o&&o!=w){x+=o+" "+p+", "}x+=w+" "+(q||"ASC")}if(v){this.conn.query("SELECT count(*) as count FROM "+l.table.name+x,function(A,C,i,B,z){if(!C){this.handleError(r,i,B,z,h,k,l);return}x+=" LIMIT ";if(Ext.isNumber(j)){x+=j+","}x+=v;l.table.selectBy(x,g,this.createCallback(r,i.records[0].count,null,b,k,l,h),this)},this)}else{l.table.selectBy(x,g,this.createCallback(r,null,null,b,k,l,h),this)}break}},processNextRow:function(b,d,g,j,i,l){var a=d[this.recordCounter++],f,k=i.table.keyName,h;switch(b){case Ext.data.Api.actions.create:f=this.processData(a.data,g);i.table.insert(f,this.createCallback(b,d,a.data,g,j,i,l),this);break;case Ext.data.Api.actions.update:if(a.dirty){h=a.getChanges();f=this.processData(h,g);i.table.updateBy(f,k+" = ?",[a.id],this.createCallback(b,d,a.data,g,j,i,l),this)}else{processNextRow(b,i)}break}},handleError:function(i,a,h,b,d,j,g){var f=(function(){this.fireEvent("exception",this,"response",i,a,h,b);j.call(g,null,d,false)}).createDelegate(this);if(this.conn.conn.inTransaction){if(this.inTransaction){this.conn.conn.rollbackToSavepoint(null,new air.Responder(f,f))}else{this.conn.conn.rollback(new air.Responder(f,f))}}else{f()}},createCallback:function(h,d,g,b,i,f,a){return function(n,q,j,o,m){if(!q){this.handleError(h,j,o,m,a,i,f);return}if(h===Ext.data.Api.actions.read){var l={};l[b.meta.root]=j.records;if(Ext.isNumber(d)){l[b.meta.totalProperty]=d}this.onRead(h,l,b,i,f,a)}else{if(h===Ext.data.Api.actions.create){g[b.meta.idProperty]=j.insertId}this.dataStack.push(g);if(this.recordCounter<d.length){this.processNextRow(h,d,b,i,f,a)}else{var p=this.onWrite.createDelegate(this,[h,j,d,this.dataStack,b,i,f,a]),k=this.handleError.createDelegate(this,[h,null,null,null,a,i,f]);if(this.conn.conn.inTransaction){if(this.inTransaction){this.conn.conn.releaseSavepoint(null,new air.Responder(p,k))}else{this.conn.conn.commit(new air.Responder(p,k))}}else{p()}}}}},onRead:function(h,f,d,i,g,b){var a=d.readRecords(f);this.fireEvent("load",this,f,b);i.call(g,a,b,true)},onWrite:function(b,k,d,f,g,h,i,j){var a=g.extractData([].concat(f),false);this.fireEvent("write",this,b,a,k,d,j);h.call(i,a,k,true)},processData:function(d,g){var h=g.recordType.prototype.fields,a={};for(var j in d){var i=h.key(j),b,l,m;if(i){b=i.mapping?i.mapping:i.name,l=d[j],m=Ext.isObject(i.type)?i.type.type:i.type;switch(m){case"date":a[b]=l?l.format(this.conn.dateFormat||"Y-m-d H:i:s"):null;break;case"bool":case"boolean":a[b]=(!l||l==="false")?0:1;break;case"int":case"integer":a[b]=parseInt(l);break;case"float":a[b]=parseFloat(l);break;default:a[b]=l;break}}}return a},load:Ext.emptyFn,buildUrl:Ext.emptyFn});Ext.data.SQLiteStore=Ext.extend(Ext.data.Store,{autoSave:true,constructor:function(b){b=b||{};var a=b.idProperty||b.key||this.idProperty||this.key;b.batch=true;b.restful=false;if(!b.reader){b.reader=new Ext.data.JsonReader({idProperty:a,fields:b.fields||this.fields,root:"__root__",totalProperty:"__total__",})}if(!b.writer){b.writer=new Ext.data.JsonWriter({encode:false})}if(!b.proxy){b.proxy=new Ext.data.SQLiteProxy(Ext.copyTo({},b,"conn,dbFile,api"))}delete b.conn;delete b.dbFile;Ext.data.SQLiteStore.superclass.constructor.call(this,b);if(this.autoCreateTable===true){var d=function(){this.proxy.conn.createTable({name:this.tableName,key:a,fields:this.reader.recordType.prototype.fields})};if(this.proxy.conn.isOpen()){d.call(this)}else{this.proxy.conn.on("open",d,this,{single:true})}}this.table=this.proxy.conn.getTable(this.tableName,a);this.on("beforeload",function(g,i){if(!Ext.isEmpty(this.removed)){var f=[];Ext.each(this.removed,function(j){f.push(j.id)});var h=String.leftPad("",f.length,"?");h=h.split("").join(",");Ext.apply(i.params,{where:a+" NOT IN ("+h+")",args:f})}},this)}});Ext.data.GroupingSQLiteStore=Ext.extend(Ext.data.GroupingStore,{autoSave:true,constructor:function(f){f=f||{};this.hasMultiSort=true;this.multiSortInfo=this.multiSortInfo||{sorters:[]};var g=this.multiSortInfo.sorters,d=f.groupField||this.groupField,b=f.sortInfo||this.sortInfo,a=f.groupDir||this.groupDir;if(d){g.push({field:d,direction:a})}if(b){g.push(b)}Ext.data.SQLiteStore.prototype.constructor.call(this,f);this.addEvents("groupchange");this.applyGroupField()}});Ext.tree.LocalTreeLoader=Ext.extend(Ext.tree.TreeLoader,{dataFn:Ext.emptyFn,requestData:function(d,f,b){if(this.fireEvent("beforeload",this,d,f)!==false){var a=(this.dataFn||this.fn).call(this,d);this.processResponse(a,d,f,b);this.fireEvent("load",this,d,a)}else{this.runCallback(f,b||d,[])}},processResponse:function(b,g,k,f){try{g.beginUpdate();for(var d=0,a=b.length;d<a;d++){var j=this.createNode(b[d]);if(j){g.appendChild(j)}}g.endUpdate();this.runCallback(k,f||g,[g])}catch(h){this.handleFailure({argument:{node:g,callback:k,scope:f},response:b})}},load:function(b,d,a){if(this.clearOnLoad){while(b.firstChild){b.removeChild(b.firstChild)}}if(this.doPreload(b)){this.runCallback(d,a||b,[b])}else{if(this.dataFn||this.fn){this.requestData(b,d,a||b)}}}});Ext.tree.FileTreeLoader=function(a){Ext.tree.FileTreeLoader.superclass.constructor.call(this,a);if(!this.directory){this.directory=air.File.desktopDirectory}};Ext.extend(Ext.tree.FileTreeLoader,Ext.tree.LocalTreeLoader,{showHidden:false,extensionFilter:false,dirOnly:false,skipNames:[],checkLeaf:false,applyAttributes:function(b,a){return b},getNodeConfig:function(b,a){return this.applyAttributes({text:b.name,url:b.url,cls:b.isHidden?"hidden":"",iconCls:a?"drive":(b.isDirectory?"folder":"file"+(b.extension?"-"+b.extension.toLowerCase():"")),extension:b.extension,leaf:!b.isDirectory},b)},onDirectoryListing:function(g,f){var h=f.files,b,a=h.length,d=[];g.total=a;for(b=0;b<a;b++){if(this.isValidFile(h[b],g.isWinRoot)){if(this.checkLeaf===true&&h[b].isDirectory){h[b].addEventListener(air.FileListEvent.DIRECTORY_LISTING,this.onCheckLeafListing.createDelegate(this,[g,d,h[b]],0));h[b].getDirectoryListingAsync()}else{d.push(this.getNodeConfig(h[b],g.isWinRoot));if(d.length>=g.total){this.fireLoad(d,g.node,g.callback,g.scope)}}}else{g.total--;if(d.length>=g.total){this.fireLoad(d,g.node,g.callback,g.scope)}}}},onCheckLeafListing:function(i,g,f,h){var k=h.files,a=k.length,d,b=true;for(d=0;d<a;d++){if(this.isValidFile(k[d],i.isWinRoot)){b=false;break}}g.push(Ext.apply(this.getNodeConfig(f,i.isWinRoot),{leaf:b}));if(g.length>=i.total){this.fireLoad(g,i.node,i.callback,i.scope)}},isValidFile:function(b,a){return this.skipNames.indexOf(b.name)==-1&&(b.isDirectory||((this.extensionFilter===false||this.extensionFilter.indexOf(Ext.value(b.extension,"").toLowerCase())!=-1)&&this.dirOnly===false))&&(!b.isHidden||a||this.showHidden===true)},requestData:function(b,d,a){if(this.fireEvent("beforeload",this,b,d)!==false){(this.dataFn||this.fn).call(this,b,d,a)}else{this.runCallback(d,a||b,[])}},fireLoad:function(d,b,f,a){this.processResponse(d,b,f,a);this.fireEvent("load",this,b,d)},dataFn:function(b,g,d){var a,f={node:b,callback:g,scope:d,isWinRoot:false};if(b.attributes.url==="/"||b.attributes.url==="file:///"||(Ext.isEmpty(b.attributes.url)&&this.directory==="/")){if(Ext.isWindows){f.isWinRoot=true}else{a=air.File.getRootDirectories()[0]}}else{if(b.attributes.url){a=new air.File(b.attributes.url)}else{a=this.directory.clone()}}if(!Ext.isArray(this.extensionFilter)&&this.extensionFilter!==false){this.extensionFilter=[this.extensionFilter]}if(!Ext.isArray(this.skipNames)){this.skipNames=[this.skipNames]}if(f.isWinRoot){c=air.File.getRootDirectories();this.onDirectoryListing(f,{files:c})}else{a.addEventListener(air.FileListEvent.DIRECTORY_LISTING,this.onDirectoryListing.createDelegate(this,[f],0));a.getDirectoryListingAsync()}}});Ext.air.App=function(){return{launchOnStartup:function(a){air.NativeApplication.nativeApplication.startAtLogin=!!a},autoExit:function(a){air.NativeApplication.nativeApplication.autoExit=!!a},getActiveWindow:function(){return air.NativeApplication.nativeApplication.activeWindow},getNativeApplication:function(){return air.NativeApplication.nativeApplication},getRootWindow:function(){return air.NativeApplication.nativeApplication.openedWindows[0]},getRootHtmlWindow:function(){return Ext.air.App.getRootWindow().stage.getChildAt(0).window}}}();Ext.air.DragType={TEXT:"text/plain",HTML:"text/html",URL:"text/uri-list",BITMAP:"image/x-vnd.adobe.air.bitmap",FILES:"application/x-vnd.adobe.air.file-list"};Ext.air.Clipboard=function(){var a=air.Clipboard.generalClipboard;return{hasData:function(b){return a.hasFormat(b)},setData:function(d,b){a.setData(d,b)},setDataHandler:function(d,b){a.setDataHandler(d,b)},getData:function(d,b){a.getData(d,b)},clear:function(){a.clear()},clearData:function(b){a.clearData(b)}}}();Ext.air.MenuItem=function(g){if(!g.isAction){g=new Ext.Action(g)}var b=g.initialConfig;var a=new air.NativeMenuItem(b.itemText||b.text);a.enabled=!b.disabled;if(!Ext.isEmpty(b.checked)){a.checked=b.checked}var f=b.handler;var d=b.scope;a.addEventListener(air.Event.SELECT,function(){f.call(d||window,b)});g.addComponent({setDisabled:function(h){a.enabled=!h},setText:function(h){a.label=h},setVisible:function(h){a.enabled=!h},setHandler:function(h,i){f=h;d=i},on:function(){}});return a};Ext.air.SystemMenu=function(){var b;if(air.NativeWindow.supportsMenu&&nativeWindow.systemChrome!=air.NativeWindowSystemChrome.NONE){b=new air.NativeMenu();nativeWindow.menu=b}if(air.NativeApplication.supportsMenu){b=air.NativeApplication.nativeApplication.menu}function a(h,g){for(var f=0,d=h.items.length;f<d;f++){if(h.items[f]["label"]==g){return h.items[f]}}return null}return{add:function(k,j,h){var g=a(b,k);if(!g){g=b.addItem(new air.NativeMenuItem(k));g.mnemonicIndex=h||0;g.submenu=new air.NativeMenu()}for(var f=0,d=j.length;f<d;f++){g.submenu.addItem(j[f]=="-"?new air.NativeMenuItem("",true):Ext.air.MenuItem(j[f]))}return g.submenu},get:function(){return b}}}();Ext.air.SystemTray=function(){var f=air.NativeApplication.nativeApplication;var b,a=false,d;if(air.NativeApplication.supportsSystemTrayIcon){b=f.icon;a=true}if(air.NativeApplication.supportsDockIcon){b=f.icon}return{setIcon:function(j,h,i){if(!b||!j){return}var g=new air.Loader();g.contentLoaderInfo.addEventListener(air.Event.COMPLETE,function(k){d=new runtime.Array(k.target.content.bitmapData);if(i){b.bitmaps=d}});g.load(new air.URLRequest(j));if(h&&air.NativeApplication.supportsSystemTrayIcon){f.icon.tooltip=h}},bounce:function(g){b.bounce(g)},on:function(g,i,h){b.addEventListener(g,function(){i.apply(h||this,arguments)})},hideIcon:function(){if(!b){return}b.bitmaps=[]},showIcon:function(){if(!b){return}b.bitmaps=d},setMenu:function(n,j){if(!b){return}var m=new air.NativeMenu();for(var k=0,g=n.length;k<g;k++){var h=n[k];if(h=="-"){m.addItem(new air.NativeMenuItem("",true))}else{var l=m.addItem(Ext.air.MenuItem(h));if(h.menu||(h.initialConfig&&h.initialConfig.menu)){l.submenu=Ext.air.SystemTray.setMenu(h.menu||h.initialConfig.menu,m)}}if(!j){b.menu=m}}return m}}}();Ext.air.Sound={play:function(d,b){var a=air.File.applicationDirectory.resolvePath(d);var f=new air.Sound();f.load(new air.URLRequest(a.url));f.play(b)}};Ext.air.MusicPlayer=function(a){a=a||{};Ext.apply(this,a);this.addEvents("stop","pause","play","load","id3info","complete","progress","skip");Ext.air.MusicPlayer.superclass.constructor.call(this,a);this.onSoundFinishedDelegate=this.onSoundFinished.createDelegate(this);this.onSoundLoadDelegate=this.onSoundLoad.createDelegate(this);this.onSoundID3LoadDelegate=this.onSoundID3Load.createDelegate(this);Ext.TaskMgr.start({run:this.notifyProgress,scope:this,interval:this.progressInterval})};Ext.extend(Ext.air.MusicPlayer,Ext.util.Observable,{activeSound:null,activeChannel:null,activeTransform:new air.SoundTransform(1,0),pausePosition:0,progressInterval:500,adjustVolume:function(a){this.activeTransform.volume=a;if(this.activeChannel){this.activeChannel.soundTransform=this.activeTransform}},stop:function(){this.pausePosition=0;if(this.activeChannel){this.activeChannel.stop();this.activeChannel=null}if(this.activeSound){this.activeSound.removeEventListener(air.Event.COMPLETE,this.onSoundLoadDelegate);this.activeSound.removeEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);this.activeSound.removeEventListener(air.Event.SOUND_COMPLETE,this.onSoundFinishedDelegate)}this.fireEvent("stop",this)},pause:function(){if(this.activeChannel){this.pausePosition=this.activeChannel.position;this.activeChannel.stop();this.fireEvent("pause",this.activeChannel,this.activeSound,this.pausePosition)}},play:function(a){if(a){this.stop();var b=new air.URLRequest(a);this.activeSound=new air.Sound();this.activeSound.addEventListener(air.Event.SOUND_COMPLETE,this.onSoundFinishedDelegate);this.activeSound.addEventListener(air.Event.COMPLETE,this.onSoundLoadDelegate);this.activeSound.addEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);this.activeSound.load(b)}else{this.onSoundLoad()}this.fireEvent("play",this.activeChannel,this.activeSound)},skipTo:function(a){if(this.activeChannel){this.activeChannel.stop();this.activeChannel=this.activeSound.play(a);this.activeChannel.soundTransform=this.activeTransform;this.fireEvent("skip",this.activeChannel,this.activeSound,a)}},hasActiveChannel:function(){return !!this.activeChannel},onSoundLoad:function(a){if(this.activeSound){if(this.activeChannel){this.activeChannel.stop()}this.activeChannel=this.activeSound.play(this.pausePosition);this.activeChannel.soundTransform=this.activeTransform;this.fireEvent("load",this.activeChannel,this.activeSound)}},onSoundFinished:function(a){this.fireEvent("complete",a)},onSoundID3Load:function(b){this.activeSound.removeEventListener(air.Event.ID3,this.onSoundID3LoadDelegate);var a=b.target.id3;this.fireEvent("id3info",a)},notifyProgress:function(){if(this.activeChannel&&this.activeSound){var a=100*(this.activeChannel.position/this.activeSound.length);if(a>99.7){this.onSoundFinished()}else{this.fireEvent("progress",this.activeChannel,this.activeSound)}}}});Ext.air.VideoPanel=Ext.extend(Ext.Panel,{autoResize:true,initComponent:function(){var a=new air.NetConnection();a.connect(null);this.stream=new air.NetStream(a);this.stream.client={onMetaData:Ext.emptyFn};Ext.air.VideoPanel.superclass.initComponent.call(this);this.on("bodyresize",this.onVideoResize,this)},afterRender:function(){Ext.air.VideoPanel.superclass.afterRender.call(this);(function(){var a=this.body.getBox();this.video=new air.Video(this.getInnerWidth(),this.getInnerHeight());if(this.url){this.video.attachNetStream(this.stream);this.stream.play(this.url)}nativeWindow.stage.addChild(this.video);this.video.x=a.x;this.video.y=a.y}).defer(500,this)},onVideoResize:function(d,a,f){if(this.video&&this.autoResize){var b=this.getInnerWidth();var g=this.getInnerHeight();this.video.width=b;this.video.height=g;var i=this.body.getXY();if(i[0]!==this.video.x){this.video.x=i[0]}if(i[1]!==this.video.y){this.video.y=i[1]}}},loadVideo:function(a){this.stream.close();this.video.attachNetStream(this.stream);this.stream.play(a)}});Ext.reg("videopanel",Ext.air.VideoPanel);Ext.air.NativeObservable=Ext.extend(Ext.util.Observable,{addListener:function(b){this.proxiedEvents=this.proxiedEvents||{};if(!this.proxiedEvents[b]){var a=this;var d=function(){var f=Array.prototype.slice.call(arguments,0);f.unshift(b);a.fireEvent.apply(a,f)};this.proxiedEvents[b]=d;this.getNative().addEventListener(b,d)}Ext.air.NativeObservable.superclass.addListener.apply(this,arguments)}});Ext.air.NativeObservable.prototype.on=Ext.air.NativeObservable.prototype.addListener;Ext.air.NativeWindow=function(d){d=d||{};Ext.apply(this,d);this.id=this.id||Ext.id();this.openedWindows=[];this.addEvents("complete","activate","deactivate","beforeclose","close","beforehide","hide","beforeshow","show","maximize","minimize","restore","titlechange","move","resize","beforestaterestore","staterestore","beforestatesave","statesave","fullscreen");Ext.air.NativeWindow.superclass.constructor.call(this,d);if(!this.win){if(!Ext.isDefined(this.file)&&!Ext.isDefined(this.html)){this.queryFiles()}var b=new air.NativeWindowInitOptions();b.systemChrome=(this.type==air.NativeWindowType.LIGHTWEIGHT)?air.NativeWindowSystemChrome.NONE:this.systemChrome;b.type=this.type;b.resizable=!!this.resizable;b.minimizable=!!this.minimizable;b.maximizable=!!this.maximizable;b.transparent=!!this.transparent&&(this.systemChrome!=air.NativeWindowSystemChrome.STANDARD);this.loader=air.HTMLLoader.createRootWindow(false,b,false);if(this.trusted===true&&!Ext.isAir1){this.loader.placeLoadStringContentInApplicationSandbox=true}if(this.file){this.loader.load(new air.URLRequest(this.file))}else{this.loader.loadString(this.html||"")}this.win=this.loader.window.nativeWindow}else{Ext.apply(this,{loader:this.win.stage.getChildAt(0),maximizable:this.win.maximizable,minimizable:this.win.minimizable,resizable:this.win.resizable,minWidth:Ext.isNumber(d.minWidth)?d.minWidth:this.win.minSize.x,minHeight:Ext.isNumber(d.minHeight)?d.minHeight:this.win.minSize.y,maxWidth:Ext.isNumber(d.maxWidth)?d.maxWidth:this.win.maxSize.x,maxHeight:Ext.isNumber(d.maxHeight)?d.maxHeight:this.win.maxSize.y});Ext.applyIf(this,{width:this.win.width,height:this.win.height,x:this.win.x,y:this.win.y})}if(this.stateful!==false){this.initState()}this.toggleAlwaysInFront(this.alwaysInFront);this.win.minSize=new air.Point(Ext.isNumber(this.minWidth)?Math.max(0,this.minWidth):200,Ext.isNumber(this.minHeight)?Math.max(0,this.minHeight):100);this.win.maxSize=new air.Point(Ext.isNumber(this.maxWidth)?Math.max(0,this.maxWidth):air.NativeWindow.systemMaxSize.x,Ext.isNumber(this.maxHeight)?Math.max(0,this.maxHeight):air.NativeWindow.systemMaxSize.y);var f=(this.width||0).constrain(this.win.minSize.x,this.win.maxSize.x),a=(this.height||0).constrain(this.win.minSize.y,this.win.maxSize.y);this.setSize(f,a);this.center().setPosition(this.x||this.win.x,this.y||this.win.y);this.on("complete",this.ensureActive,this,{single:true});this.closeOnParentFn=(function(){this.parentWin.removeEventListener(air.Event.CLOSE,this.closeOnParentFn);this.close()}).createDelegate(this);this.activateModalOnParentFn=(function(){if(this.modal&&this.isVisible()){this.setActive(true)}}).createDelegate(this);this.activateParentOnCloseFn=(function(){this.parentWin.removeEventListener(air.Event.ACTIVATE,this.activateModalOnParentFn);if(this.modal){this.parentWin.activate()}}).createDelegate(this);this.parentWin=null;this.applyParentWindow(this.parent);this.initEvents();if(!this.manager){try{this.manager=Ext.air.App.getRootHtmlWindow().Ext.air.NativeWindowManager}catch(g){this.manager=Ext.air.NativeWindowManager}}this.manager.register(this);if(this.minimizeToTray){this.initMinimizeToTray(this.trayIcon,this.trayMenu)}};Ext.extend(Ext.air.NativeWindow,Ext.util.Observable,{fileQuery:{type:"queryExt",root:Ext.air.App.getRootHtmlWindow().document},minHeight:100,minWidth:200,maxHeight:air.NativeWindow.systemMaxSize.y,maxWidth:air.NativeWindow.systemMaxSize.x,alwaysInFront:false,closable:true,closeAction:"close",draggable:true,hidden:true,maximizable:false,maximized:false,minimizable:false,modal:false,resizable:true,systemChrome:air.NativeWindowSystemChrome.STANDARD,type:air.NativeWindowType.NORMAL,transparent:false,minimizeToTray:false,trayIcon:null,trayMenu:null,trayTip:null,stateful:true,stateEvents:["move","resize"],trusted:false,notify:undefined,applyParentWindow:function(a){if(this.parentWin){this.parentWin.removeEventListener(air.Event.CLOSE,this.closeOnParentFn);this.parentWin.removeEventListener(air.Event.ACTIVATE,this.activateModalOnParentFn);this.un("close",this.activateParentOnCloseFn)}this.parentWin=a!==false?(Ext.isObject(a)?a.win||a:Ext.air.App.getActiveWindow()||window.nativeWindow):null;if(this.parentWin){if(this.destroyOnParentClose!==false){this.parentWin.addEventListener(air.Event.CLOSE,this.closeOnParentFn)}this.parentWin.addEventListener(air.Event.ACTIVATE,this.activateModalOnParentFn);this.on("close",this.activateParentOnCloseFn)}},initEvents:function(){var a=["activate","deactivate","close","closing","displayStateChange","displayStateChanging","move","moving","resize","resizing"];Ext.each(a,function(d){this.win.addEventListener(d,this["on"+Ext.util.Format.capitalize(d)].createDelegate(this))},this);this.win.stage.addEventListener(air.Event.FULLSCREEN,this.onFullscreen.createDelegate(this));if(this.stateful!==false){this.initStateEvents()}if(this.loader.loaded){this.onComplete()}else{var b=(function(){this.loader.removeEventListener(air.Event.COMPLETE,b);this.onComplete()}).createDelegate(this);this.loader.addEventListener(air.Event.COMPLETE,b)}},onComplete:function(){this.fireEvent("complete",this)},onActivate:function(){this.fireEvent("activate",this)},onDeactivate:function(b){var a=Ext.air.App.getActiveWindow();if(this.modal&&this.isVisible()&&a!==null&&this.openedWindows.indexOf(a)!=-1){this.setActive(true)}this.fireEvent("deactivate",this)},onClosing:function(b){var a=!this.closable?false:this.fireEvent("beforeclose",this);if((this.closeAction=="hide"||a===false)&&b.cancelable){b.preventDefault();if(a!==false&&this.closeAction=="hide"){this.hide()}}},onClose:function(){this.manager.unregister(this);this.fireEvent("close",this)},onDisplaystatechanging:function(a){if(a.cancelable&&((a.afterDisplayState==air.NativeWindowDisplayState.MAXIMIZED&&!this.maximizable)||(a.afterDisplayState==air.NativeWindowDisplayState.MINIMIZED&&!this.minimizable))){a.preventDefault()}if(a.afterDisplayState==air.NativeWindowDisplayState.MAXIMIZED){this.stateBounds=this.win.bounds}},onDisplaystatechange:function(){if(this.win.displayState==air.NativeWindowDisplayState.MAXIMIZED){this.fireEvent("maximize",this)}else{if(this.win.displayState==air.NativeWindowDisplayState.MINIMIZED){this.fireEvent("minimize",this)}else{this.fireEvent("restore",this)}}},onMoving:function(a){if(!this.draggable&&a.cancelable){a.preventDefault()}},onMove:function(a){this.fireEvent("move",this,a.afterBounds.x,a.afterBounds.y)},onResizing:function(a){if(a.cancelable&&(!this.resizable||a.afterBounds.width<this.minWidth||a.afterBounds.height<this.minHeight)){a.preventDefault()}},onResize:function(a){this.fireEvent("resize",this,a.afterBounds.width,a.afterBounds.height)},onFullscreen:function(a){this.fireEvent("fullscreen",this,!!a.fullScreen)},initState:Ext.Component.prototype.initState,getStateId:Ext.Component.prototype.getStateId,initStateEvents:Ext.Component.prototype.initStateEvents,applyState:Ext.Component.prototype.applyState,saveState:Ext.Component.prototype.saveState,getState:function(){var a=(this.win.displayState==air.NativeWindowDisplayState.MAXIMIZED),b=this.stateBounds;return{maximized:a,width:a&&b?b.width:this.win.width,height:a&&b?b.height:this.win.height,x:a&&b?b.x:this.win.x,y:a&&b?b.y:this.win.y}},center:function(){var a=air.Screen.mainScreen.visibleBounds;this.win.x=a.x+(a.width-this.win.width)/2;this.win.y=a.y+(a.height-this.win.height)/2;return this},close:function(){if(!this.isVisible()){this.doClose()}else{this.hide(this.doClose,this)}},doClose:function(){this.purgeListeners();this.closable=true;this.closeAction="close";this.win.close()},getId:function(){return this.id},getHeight:function(){return this.win.height},getWidth:function(){return this.win.width},getInnerHeight:function(){return this.win.stage.stageHeight},getInnerWidth:function(){return this.win.stage.stageWidth},getPosition:function(){return[this.win.x,this.win.y]},getSize:function(){return{width:this.win.width,height:this.win.height}},hide:function(b,a){if(!this.isVisible()||this.fireEvent("beforehide",this)===false){return this}this.win.visible=false;this.onHide();if(window.nativeWindow&&!window.nativeWindow.closed&&window.nativeWindow.displayState!=air.NativeWindowDisplayState.MINIMIZED&&window.nativeWindow!=this.win){window.nativeWindow.activate()}this.fireEvent("hide",this);if(Ext.isFunction(b)){b.call(a||this)}},onHide:Ext.emptyFn,isVisible:function(){return !this.win.closed&&this.win.visible},maximize:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.MAXIMIZED);if(this.win.dispatchEvent(a)===false){return this}}this.win.maximize();return this},minimize:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.MINIMIZED);if(this.win.dispatchEvent(a)===false){return this}}this.win.minimize();return this},restore:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.NORMAL);if(this.win.dispatchEvent(a)===false){return this}}this.win.restore();return this},setActive:function(a){if(a){this.show();this.win.activate()}else{this.fireEvent("deactivate",this)}},setHeight:function(a){this.win.height=parseInt(a);return this},setWidth:function(a){this.win.width=parseInt(a);return this},setPosition:function(a,b){if(Ext.isDefined(a)){this.win.x=parseInt(a)}if(Ext.isDefined(b)){this.win.y=parseInt(b)}return this},setSize:function(a,b){if(Ext.isObject(a)){b=a.height;a=a.width}if(Ext.isDefined(a)){this.win.width=parseInt(a)}if(Ext.isDefined(b)){this.win.height=parseInt(b)}return this},setTitle:function(a){this.win.title=a;this.fireEvent("titlechange",this,a)},setVisible:function(a){if(!a){this.hide()}else{this.show()}return this},show:function(b,a){if(this.trayed){Ext.air.SystemTray.hideIcon();this.trayed=false}if(this.isVisible()){this.toFront();return this}if(this.fireEvent("beforeshow",this)===false){return this}this.win.visible=true;this.memorizeOpenedWindows();this.toFront();this.onShow();this.fireEvent("show",this);if(Ext.isFunction(b)){b.call(a||this)}},onShow:Ext.emptyFn,toBack:function(){this.win.orderToBack();return this},toFront:function(){this.win.orderToFront();return this},inBackOf:function(a){this.win.orderInBackOf(a.win?a.win:a);return this},inFrontOf:function(a){this.win.orderInFrontOf(a.win?a.win:a);return this},fullscreen:function(a){this.win.stage.displayState=a?air.StageDisplayState.FULL_SCREEN:air.StageDisplayState.FULL_SCREEN_INTERACTIVE},getNative:function(){return this.win},toggleMaximize:function(){this[this.win.displayState==air.NativeWindowDisplayState.MAXIMIZED?"restore":"maximize"];return this},toggleFullscreen:function(a){var b=air.StageDisplayState.NORMAL;if(this.win.stage.displayState==b){this.fullscreen(a)}else{this.win.stage.displayState=air.StageDisplayState.NORMAL}},toggleAlwaysInFront:function(a){this.win.alwaysInFront=(Ext.isBoolean(a))?a:!this.win.alwaysInFront;return this},ensureActive:function(){var a=Ext.air.App.getActiveWindow();if(a!=this.parentWin&&a!=this.win){if(this.notify===true||!Ext.isDefined(this.notify)){this.notify=air.NotificationType[this.notify===true||this.modal?"CRITICAL":"INFORMATIONAL"]}if(this.notify==air.NotificationType.CRITICAL||this.notify==air.NotificationType.INFORMATIONAL){this.win.notifyUser(this.notify)}if(this.modal&&this.parentWin){this.on("activate",function(){this.parentWin.activate();this.setActive(true)},this,{single:true,delay:10});if(this.hidden===false){this.win.visible=true}}}if(!this.win.visible&&this.hidden===false){this.setActive(true)}if(this.maximized){this.maximize()}},memorizeOpenedWindows:function(){this.openedWindows=Ext.toArray(air.NativeApplication.nativeApplication.openedWindows)||[];this.openedWindows.remove(this.win)},getWindow:function(){return this.win.stage.getChildAt(0).window},getDocument:function(){return this.getWindow().document},initMinimizeToTray:function(b,d){var a=Ext.air.SystemTray;a.setIcon(b,this.trayTip);this.on("minimize",function(){a.showIcon();this.hide();this.trayed=true},this);a.on("click",function(){this.setActive(true)},this);if(d){a.setMenu(d)}this.trayed=false},queryFiles:function(){var o;if(Ext.isObject(this.fileQuery)&&(o=this.fileQuery.type)){if(o=="main"){var A=air.NativeApplication.nativeApplication.applicationDescriptor,w=new DOMParser(),b=w.parseFromString(A,"text/xml"),z=Ext.DomQuery.selectValue("initialWindow/content",b,"");if(!Ext.isEmpty(z)){var u=z.indexOf("?");if(u!=-1){z=z.substring(0,u)}this.file=z+"?window="+this.id}}else{var n="",p=this.fileQuery.regex,v=this.fileQuery.js!==false,m=this.fileQuery.css!==false,g,i,x,z,B,j="[type=text/javascript]",d="[type=text/css]",y='<script language="JavaScript" type="text/javascript" src="{0}"><\/script>',l='<link rel="stylesheet" type="text/css" href="{0}" />',k=this.fileQuery.include;if(!v&&!m){return}if(o=="queryExtJS"){p=/\/ext\-(basex?|all|lang)(\-[a-z_\-]+)?\.(css|js)$/i}else{if(o=="queryExtAIR"){p=/\/(AIRAliases\.js)|(AIRIntrospector\.js)|(AIRLocalizer\.js)|(AIRMenuBuilder\.js)|(AIRSourceViewer\.js)|(ext\-air(\-[a-z_\-]+)?\.(css|js))$/i}else{if(o=="queryExt"){p=/\/(AIRAliases\.js)|(AIRIntrospector\.js)|(AIRLocalizer\.js)|(AIRMenuBuilder\.js)|(AIRSourceViewer\.js)|(ext\-(basex?|all|lang|air)(\-[a-z_\-]+)?\.(css|js))$/i}}}switch(o){case"queryExtJS":case"queryExtAIR":case"queryExt":case"queryRegex":if(!Ext.isDefined(p)){return}z=Ext.DomQuery.select(v&&m?"link"+d+",style"+d+",script"+j:(m?"link"+d+",style"+d:"script"+j),this.fileQuery.root);Ext.each(z,function(a){g=a.tagName=="LINK";if(this.fileQuery.includeAllCSS===true&&(g||a.tagName=="STYLE")){n+=a.outerHTML}else{if(a.tagName!="STYLE"){x=g?a.href:a.src;if(p.test(x)){n+=a.outerHTML}}}},this);break;case"queryAttribute":if(!Ext.isString(this.fileQuery.attribute)){return}B=this.fileQuery.attribute;case"queryAll":this.fileQuery.selector=v&&m?"link"+d+",style"+d+",script"+j:(m?"link"+d+",style"+d:"script"+j);case"querySelector":if(!Ext.isString(this.fileQuery.selector)){return}z=Ext.DomQuery.select(this.fileQuery.selector,this.fileQuery.root);Ext.each(z,function(a){g=(a.tagName=="LINK"||a.tagName=="STYLE")&&a.type=="text/css";i=a.tagName=="SCRIPT"&&a.type=="text/javascript";if((!g&&!i)||(g&&!m)||(i&&!v)){return true}if(o!="queryAttribute"||Ext.fly(a).getAttribute(B,"ext")=="true"){n+=a.outerHTML}});break}if(k){k=Ext.isArray(k)?k:[k];Ext.each(k,function(a){switch(a.substring(a.lastIndexOf(".")+1).toLowerCase()){case"js":n+=String.format(y,a);break;case"css":n+=String.format(l,a);break}})}if(!Ext.isEmpty(n)){this.html="<html><head>"+n+"</head><body>"+(this.fileQuery.bodyHtml||"")+"</body></html>";this.trusted=true}}}}});Ext.air.NativeWindowGroup=function(){var a={};return{register:function(b){a[b.id]=b},unregister:function(b){delete a[b.id]},get:function(d){if(Ext.isString(d)){return a[d]}else{d=d.nativeWindow||d;for(var b in a){if(a.hasOwnProperty(b)&&a[b].win==d){return a[b]}}}return undefined},closeAll:function(){for(var b in a){if(a.hasOwnProperty(b)){a[b].close()}}},each:function(d,b){for(var f in a){if(a.hasOwnProperty(f)){if(d.call(b||a[f],a[f])===false){return}}}}}};Ext.air.NativeWindowManager=new Ext.air.NativeWindowGroup();Ext.air.Notify=function(a){a=a||{};Ext.apply(this,a);var b=this.tpl.apply({msg:this.msg,iconCls:this.iconCls,icon:this.icon||Ext.BLANK_IMAGE_URL,title:this.title,msgId:this.msgId,boxCls:this.boxCls,cls:this.cls,style:this.style});if(this.boxCls!==false){var g=Ext.fly(document.createElement("div")),h=g.insertHtml("afterBegin",b,true);h.boxWrap(this.boxCls);b=g.dom.innerHTML;g.remove()}this.fileQuery.bodyHtml=b;if(this.height=="auto"){this.height=undefined;this.autoHeight=true}else{this.autoHeight=false}Ext.air.Notify.superclass.constructor.call(this,a);try{this.stack=Ext.air.App.getRootHtmlWindow().Ext.air.NotifyManager}catch(f){this.stack=Ext.air.NotifyManager}if(this.stack){this.stack.add(this)}};Ext.extend(Ext.air.Notify,Ext.air.NativeWindow,{hidden:false,systemChrome:"none",transparent:true,stateful:false,extraHeight:22,type:"lightweight",minHeight:0,destroyOnParentClose:false,notify:false,parent:false,alwaysInFront:true,width:400,height:"auto",fileQuery:{type:"queryExt",root:Ext.air.App.getRootHtmlWindow().document,js:false},hideDelay:3000,clickToClose:false,msgId:"msg",icon:undefined,iconCls:"",boxCls:"x-box",stackable:false,stackPosition:"top",tpl:new Ext.XTemplate('<div id="{msgId}" class="notify {cls}" style="{style}">','<img src="{icon}" class="notify-icon {iconCls}" />','<tpl if="title">','<div class="notify-title">{title}</div>',"</tpl>",'<div class="notify-msg">{msg}</div>',"</div>"),onShow:function(){var i=this.getDocument(),b=air.Screen.mainScreen.visibleBounds.bottomRight,a=i.body.childNodes[0].clientHeight,f=i.getElementById(this.msgId),g=f.clientHeight,d=this.autoHeight?g+this.extraHeight:parseInt(this.height,10);if(!this.autoHeight!="auto"){f.style.height=(d-a+g)+"px"}this.setHeight(d);if(this.stack){this.stack.arrange()}else{this.setPosition(b.x-this.getWidth(),b.y-d)}Ext.air.Notify.superclass.onShow.call(this);if(this.clickToClose===true){i.addEventListener("click",(function(){this.close()}).createDelegate(this),true)}if(this.hideDelay!==false){this.close.defer(this.hideDelay,this)}},onHide:function(){if(this.stack){this.stack.arrange()}Ext.air.Notify.superclass.onHide.call(this)},onClose:function(){if(this.stack){this.stack.remove(this)}Ext.air.Notify.superclass.onClose.call(this)}});Ext.air.NotifyManager=function(){var b=[],a=0;return{add:function(d){if(d.stackable&&d.stackPosition!="bottom"){b.push(d)}else{b.splice(a,0,d);if(!d.stackable){a++}}},remove:function(d){b.remove(d)},arrange:function(){var g=0,f=0,d=air.Screen.mainScreen.visibleBounds.bottomRight;Ext.each(b,function(h){if(!h.isVisible()){return}f=h.getHeight();if(h.stackable){g+=f;h.setPosition(d.x-h.getWidth(),d.y-g)}else{g=Math.max(g,f);h.setPosition(d.x-h.getWidth(),d.y-f)}})}}}();Ext.air.Viewport=Ext.extend(Ext.Panel,{monitorResize:false,baseCls:"x-window",frame:true,collapsible:false,closable:true,pinnable:false,draggable:true,closeText:"Close",restoreText:"Restore",minimizeText:"Minimize",maximizeText:"Maximize",closeAction:"close",initComponent:function(){document.getElementsByTagName("html")[0].className+=" x-viewport";var a=Ext.getBody();a.setHeight=Ext.emptyFn;a.setWidth=Ext.emptyFn;a.setSize=Ext.emptyFn;a.dom.scroll="no";Ext.EventManager.onWindowResize(this.setSize,this);this.win=window.nativeWindow;this.win.title=this.title=this.title||this.win.title;if(this.win.systemChrome!=air.NativeWindowSystemChrome.NONE||this.win.type==air.NativeWindowType.LIGHTWEIGHT){this.frame=false;this.header=false}else{this.header=true}this.renderTo=a;Ext.air.Viewport.superclass.initComponent.call(this)},onRender:function(b,a){Ext.air.Viewport.superclass.onRender.call(this,b,a);this.setSize(Ext.getBody().getSize());this.setPosition(0,0);if(this.plain){this.el.addClass(this.baseCls+"-plain")}this.initTools();this.setIcon(this.icon);this.setHeaderMenu();delete this.icon;this.addClass("x-nativewindow-"+this.win.type.toLowerCase());if(this.win.resizable&&this.win.systemChrome==air.NativeWindowSystemChrome.NONE&&this.win.type!=air.NativeWindowType.LIGHTWEIGHT){this.resizer=new Ext.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:true,startSizing:this.startSizing.createDelegate(this),handleCls:"x-window-handle"})}if(this.draggable&&this.header){this.header.addClass("x-window-draggable")}},setIcon:function(b){if(this.rendered&&this.header&&b){if(this.frame){this.header.removeClass(this.iconCls);this.header.addClass("x-panel-icon");this.header.setStyle("backgroundImage","url("+b+")")}else{var d=this.header.dom;var a=d.firstChild&&String(d.firstChild.tagName).toLowerCase()=="img"?d.firstChild:null;if(a){Ext.fly(a).removeClass(this.iconCls).setStyle("backgroundImage","url("+b+")")}else{Ext.DomHelper.insertBefore(d.firstChild,{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-panel-inline-icon",style:"background-image: url("+b+");"})}}}},setHeaderMenu:function(){if(this.header&&!this.headerMenu){this.headerMenu=new Ext.menu.Menu({cls:"x-nativewindow-headermenu",items:[{itemId:"restore",text:this.restoreText,iconCls:"restore",handler:function(){this.win.restore()},scope:this},{itemId:"minimize",text:this.minimizeText,iconCls:"minimize",handler:function(){this.win.minimize()},scope:this},{itemId:"maximize",text:this.maximizeText,iconCls:"maximize",handler:function(){this.win.maximize()},scope:this},"-",{itemId:"close",text:this.closeText,iconCls:"close",handler:this.doClose,scope:this}]});this.mon(this.header,"mousedown",function(d,b){var a=(this.dd)?this.dd.isLocked():false;if(d.getPageX()<this.header.getHeight()){this.headerMenu.show(this.header);if(this.dd){this.dd.lock()}}else{if(this.dd&&a){this.dd.unlock()}}},this);this.updateHeaderMenu()}},updateHeaderMenu:function(){var g=this.headerMenu;if(!g){return}var d=air.NativeWindowDisplayState;var b=this.win.displayState;var f=this.win.stage.displayState;var a=air.StageDisplayState.NORMAL;g.getComponent("minimize").setDisabled(!this.win.minimizable);g.getComponent("restore").setDisabled(!(f!=a||(this.win.maximizable&&b==d.MAXIMIZED)));g.getComponent("maximize").setDisabled(!(this.win.maximizable&&b==d.NORMAL&&f==a))},initEvents:function(){Ext.air.Viewport.superclass.initEvents.call(this);this.win.addEventListener(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGE,this.onDisplayStateChange.createDelegate(this));this.win.addEventListener(air.Event.ACTIVATE,this.onActivate.createDelegate(this));this.win.addEventListener(air.Event.DEACTIVATE,this.onDeactivate.createDelegate(this));this.win.stage.addEventListener(air.Event.FULLSCREEN,this.onFullscreen.createDelegate(this));if(this.header){this.mon(this.header,"dblclick",function(a){if(a.getPageX()<this.header.getHeight()){if(this.closable){this.win.close()}}else{if(this.win.maximizable){this.toggleMaximize()}}},this)}},initDraggable:function(){if(this.header){this.dd=new Ext.air.ViewportDD(this)}},onDestroy:function(){if(this.resizer){this.resizer.destroy(true)}if(this.headerMenu){this.headerMenu.destroy()}Ext.air.Viewport.superclass.onDestroy.call(this)},initTools:function(){if(this.win.type==air.NativeWindowType.NORMAL&&this.header){if(this.pinnable){this.addTool({id:"unpin",hidden:!!this.win.alwaysInFront,handler:this.toggleAlwaysInFront.createDelegate(this,[true])});this.addTool({id:"pin",hidden:!this.win.alwaysInFront,handler:this.toggleAlwaysInFront.createDelegate(this,[false])})}if(this.win.minimizable){this.addTool({id:"minimize",handler:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.MINIMIZED);if(this.win.dispatchEvent(a)===false){return}}this.win.minimize()},scope:this})}if(this.win.maximizable){this.addTool({id:"maximize",handler:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.MAXIMIZED);if(this.win.dispatchEvent(a)===false){return}}this.win.maximize()},scope:this});this.addTool({id:"restore",handler:function(){if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){var a=new air.NativeWindowDisplayStateEvent(air.NativeWindowDisplayStateEvent.DISPLAY_STATE_CHANGING,false,true,this.win.displayState,air.NativeWindowDisplayState.NORMAL);if(this.win.dispatchEvent(a)===false){return}}this.win.restore()},scope:this,hidden:true})}}if(this.closable&&this.header){this.addTool({id:"close",handler:this.doClose,scope:this})}},addTool:function(){switch(this.win.type){case air.NativeWindowType.NORMAL:Ext.air.Viewport.superclass.addTool.apply(this,arguments);break;case air.NativeWindowType.UTILITY:Ext.each(arguments,function(b){if(!(b.id&&b.id!="close"&&b.id!="help")){Ext.air.Viewport.superclass.addTool.call(this,b)}},this);break}},startSizing:function(d,b){var f={north:"TOP",east:"RIGHT",south:"BOTTOM",west:"LEFT",northeast:"TOP_RIGHT",southeast:"BOTTOM_RIGHT",southwest:"BOTTOM_LEFT",nothwest:"TOP_LEFT"};var a=f[b.position];if(a){this.win.startResize(air.NativeWindowResize[a])}},toggleMaximize:function(){this.win[this.win.displayState==air.NativeWindowDisplayState.MAXIMIZED?"restore":"maximize"]()},toggleAlwaysInFront:function(a){if(!Ext.isDefined(a)){a=!this.win.alwaysInFront}this.win.alwaysInFront=!!a;this.getTool("unpin").setVisible(!a);this.getTool("pin").setVisible(!!a)},onDisplayStateChange:function(b){var a=air.NativeWindowDisplayState;switch(b.afterDisplayState){case a.MINIMIZED:this.onMinimize();break;case a.MAXIMIZED:this.onMaximize();break;default:this.onRestore();break}this.updateHeaderMenu();return true},onMaximize:function(){this.expand(false);if(this.header&&this.win.type==air.NativeWindowType.NORMAL){if(this.win.maximizable){this.tools.maximize.hide();this.tools.restore.show()}if(this.collapsible){this.tools.toggle.hide()}}if(this.dd){this.dd.lock()}if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){this.on("resize",this.fitWindow,this,{single:true})}this.el.addClass("x-nativewindow-maximized")},fitWindow:function(){var d=air.Screen.mainScreen.visibleBounds;var a=this.getWidth()-d.width;var f=this.getHeight()-d.height;this.setPosition(a/2,f/2);this.setSize(d.width,d.height)},onRestore:function(){this.el.removeClass("x-nativewindow-maximized");if(this.header&&this.win.type==air.NativeWindowType.NORMAL){if(this.win.maximizable){this.tools.restore.hide();this.tools.maximize.show()}if(this.collapsible){this.tools.toggle.show()}}if(this.dd){this.dd.unlock()}if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){this.setPosition(0,0)}},onMinimize:Ext.emptyFn,onActivate:function(){if(this.el&&this.el.dom){this.removeClass("x-nativewindow-inactive")}},onDeactivate:function(){if(this.el&&this.el.dom){this.addClass("x-nativewindow-inactive")}},onFullscreen:function(a){if(a.fullScreen){this.expand(false);if(this.header){if(this.collapsible&&this.win.type==air.NativeWindowType.NORMAL){this.tools.toggle.hide()}if(this.win.systemChrome==air.NativeWindowSystemChrome.NONE){this.on("resize",function(l,j,d,k,f){var i=this.body.parent("."+this.baseCls+"-mc"),b=this.body.getWidth(true),g=i.getHeight(true);this.suspendEvents();this.setPosition(-this.body.getX(),-i.getY());this.setSize(2*this.getWidth()-b,2*this.getHeight()-g);this.resumeEvents()},this,{single:true})}}if(this.dd){this.dd.lock()}this.el.addClass("x-nativewindow-maximized")}else{if(this.win.displayState==air.NativeWindowDisplayState.MAXIMIZED){this.onMaximize()}else{this.onRestore()}}this.updateHeaderMenu()},doClose:function(){var a=new air.Event(air.Event.CLOSING,false,true);if(this.win.dispatchEvent(a)!==false){this.win.close()}},getNative:function(){return this.win},collapse:function(){if(this.collapsed||this.win.type!=air.NativeWindowType.NORMAL||this.fireEvent("beforecollapse",this)===false){return}this.winHeight=this.getHeight();this.onCollapse(false);return this},afterCollapse:function(){this.collapsed=true;this.el.addClass(this.collapsedCls);var a=this.getHeight();this.winMinSize=this.win.minSize;this.win.minSize=new air.Point(this.winMinSize.x,a);this.win.height=this.getHeight();this.fireEvent("collapse",this)},expand:function(){if(!this.collapsed||this.win.type!=air.NativeWindowType.NORMAL||this.fireEvent("beforeexpand",this)===false){return}this.win.minSize=this.winMinSize;this.win.height=this.winHeight;this.el.removeClass(this.collapsedCls);this.onExpand(false);return this},afterExpand:function(){this.collapsed=false;if(this.deferLayout!==undefined){this.doLayout(true)}this.fireEvent("expand",this)}});Ext.air.ViewportDD=Ext.extend(Ext.Window.DD,{startDrag:function(){this.win.win.startMove()},onDrag:Ext.emptyFn,endDrag:function(a){this.win.saveState()}});Ext.reg("airviewport",Ext.air.Viewport);Ext.air.Window=function(a){this.initialConfig=Ext.apply({},a);a.bodyHtml=this.initialConfig.html;delete a.html;this.bodyHtml=this.html;delete this.html;this.addEvents("init");Ext.air.Window.superclass.constructor.call(this,a)};Ext.extend(Ext.air.Window,Ext.air.NativeWindow,{systemChrome:air.NativeWindowSystemChrome.NONE,transparent:true,onComplete:function(){var a=this.getWindow();if(a&&a.Ext){if(a.Ext!=window.Ext){this.prepareItems()}delete this.html;this.onInit.call(this,a,a.Ext);this.createViewport(a.Ext)}Ext.air.Window.superclass.onComplete.apply(this,arguments)},onInit:function(a,b){this.fireEvent("init",this,a,b)},createViewport:function(b){var a=Ext.apply(this.getOwnProperties(),{id:b.id(),stateId:null,stateful:false,hidden:false,html:this.html||this.bodyHtml});this.viewport=new b.air.Viewport(a)},setTitle:function(b,a){Ext.air.Window.superclass.setTitle.call(this,b);if(this.viewport){this.viewport.setTitle(b,a)}},prepareItems:function(){this.items=Ext.isArray(this.items)?this.items:(this.items?[this.items]:[]);Ext.each(this.items,function(b,a){this.items[a]=b.initialConfig?b.initialConfig:b},this)},getViewport:function(){return this.viewport},getOwnProperties:function(){var d={},b=["events","stateEvents","initialConfig","win","loader","html","fileQuery","file"];for(var a in this){if(!Ext.isFunction(this[a])&&b.indexOf(a)==-1){d[a]=this[a]}}Ext.apply(d,this.initialConfig);return d}});Ext.air.MessageBox=function(){var l,a,b,n=false,t,o,k,m,i,r="",q="",j,f=null;var d=function(v){if(!v){v=(b&&b.buttons&&b.buttons.no&&!b.buttons.cancel)?"no":"cancel"}var u=a.fbar.getComponent(v);if(u){u.blur()}if(n){return false}n=true;if(l.isVisible()){l.hide();g()}Ext.callback(b.fn,b.scope||window,[v,activeTextEl.getValue(),b],1)};var g=function(){if(b&&b.cls){l.el.removeClass(b.cls)}i.reset()};var p=function(w){var x=a.fbar,u,v;x.removeAll();Ext.iterate(w,function(z,y){u=Ext.isObject(y)?y:this.buttonCfg[z];if(u){v=x.addButton(Ext.apply({},{itemId:z,handler:d.createCallback(z)},u))}},this);x.doLayout();return null};var h=function(u){if(!l){l=new Ext.air.Window({type:air.NativeWindowType.NORMAL,transparent:true,systemChrome:air.NativeWindowSystemChrome.NONE,cls:"x-window-dlg",resizable:false,minimizable:false,maximizable:false,stateful:false,modal:false,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,draggable:true,fbar:{enableOverflow:false,items:[]},fileQuery:{type:"queryExt",root:Ext.air.App.getRootHtmlWindow().document},closeAction:"hide",hidden:false,listeners:{complete:function(v){var x=v.getWindow();a=v.getViewport();t=a.body.createChild({html:'<div class="ext-mb-icon"></div><div class="ext-mb-content"><span class="ext-mb-text"></span><br /><div class="ext-mb-fix-cursor"></div></div><div class="x-clear"></div>'});o=t.first(".ext-mb-icon");msgEl=t.child(".ext-mb-text");if(x&&x.Ext){k=new x.Ext.form.TextField({listeners:{keydown:function(w){if(w.getKey()=Ext.EventObject.ENTER&&l.isVisible()&&b&&b.buttons){if(b.buttons.ok){d("ok")}else{if(b.buttons.yes){d("yes")}}}}},renderTo:t,cls:"ext-mb-input"});m=new x.Ext.form.TextArea({renderTo:t,cls:"ext-mb-textarea"});i=new x.Ext.ProgressBar({renderTo:t});j=new x.Ext.KeyMap(x.Ext.getDoc(),{key:27,handler:function(){l.hide()}})}u.call(this,l)},hide:d.createCallback(null),scope:this}})}else{u.call(this,l)}};return{updateProgress:function(v,u,w){if(i){i.updateProgress(v,u)}if(w){this.updateText(w)}return this},updateText:function(y){if(!l.isVisible()&&!b.width){l.setSize(this.maxWidth,100)}msgEl.update(y||"&#160;");var v=q!=""?(o.getWidth()+o.getMargins("lr")):0,A=msgEl.getWidth()+msgEl.getMargins("lr"),x=a.getFrameWidth("lr"),z=a.body.getFrameWidth("lr"),u;if(!Ext.isNumber(f)){f=0;a.fbar.items.each(function(w){f+=w.getWidth()+15})}u=Math.max(Math.min(b.width||v+A+x+z,b.maxWidth||this.maxWidth),Math.max(b.minWidth||this.minWidth,f||0));if(b.prompt===true){activeTextEl.setWidth(u-v-x-z)}if(b.progress===true||b.wait===true){i.setSize(u-v-x-z)}a.setSize(u,"auto");l.setSize(a.getSize()).center();return this},isVisible:function(){return l&&l.isVisible()},hide:function(){if(this.isVisible()){l.hide();g()}return this},show:function(u){if(this.isVisible()){this.hide()}b=u||{};h.call(this,function(){l.setTitle(b.title||"");var v=(b.closable!==false&&b.progress!==true&&b.wait!==true);a.getTool("close").setDisplayed(v);n=false;activeTextEl=k;b.prompt=b.prompt||(b.multiline?true:false);if(b.prompt){if(b.multiline){k.hide();m.show();m.setHeight(Ext.isNumber(b.multiline)?b.multiline:this.defaultTextHeight);activeTextEl=m}else{k.show();m.hide()}}else{k.hide();m.hide()}activeTextEl.setValue(b.value||"");if(b.iconCls){a.setIconClass(b.iconCls)}l.on("activate",function(){if(b.prompt){activeTextEl.focus(true)}else{if(b&&b.buttons){if(b.buttons.ok){a.fbar.getComponent("ok").focus()}else{if(b.buttons.yes){a.fbar.getComponent("yes").focus()}}}}},this,{single:true,delay:10});this.setIcon(Ext.isDefined(b.icon)?b.icon:r);f=p.call(this,b.buttons);i.setVisible(b.progress===true||b.wait===true);this.updateProgress(0,b.progressText);this.updateText(b.msg);if(b.cls){a.addClass(b.cls)}l.modal=b.modal!==false;l.applyParentWindow(b.parent);if(!this.isVisible()){if(j){l.on("show",function(){j.setDisabled(!v)},this,{single:true})}l.ensureActive()}if(b.wait===true){i.wait(b.waitConfig)}});return this},setIcon:function(u){if(!l){r=u;return}r=undefined;if(u&&u!=""){o.removeClass("x-hidden");o.replaceClass(q,u);t.addClass("x-dlg-icon");q=u}else{o.replaceClass(q,"x-hidden");t.removeClass("x-dlg-icon");q=""}return this},progress:function(w,v,u){this.show({title:w,msg:v,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:u});return this},wait:function(w,v,u){this.show({title:w,msg:v,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:u});return this},alert:function(x,w,v,u){this.show({title:x,msg:w,buttons:this.OK,fn:v,scope:u,minWidth:this.minWidth});return this},confirm:function(x,w,v,u){this.show({title:x,msg:w,buttons:this.YESNO,fn:v,scope:u,icon:this.QUESTION,minWidth:this.minWidth});return this},prompt:function(z,y,w,v,u,x){this.show({title:z,msg:y,buttons:this.OKCANCEL,fn:w,minWidth:this.minPromptWidth,scope:v,prompt:true,multiline:u,value:x});return this},buttonCfg:{ok:{text:"OK"},cancel:{text:"Cancel"},yes:{text:"Yes"},no:{text:"No"}},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:"ext-mb-info",WARNING:"ext-mb-warning",QUESTION:"ext-mb-question",ERROR:"ext-mb-error",defaultTextHeight:75,maxWidth:600,minWidth:100,minProgressWidth:250,minPromptWidth:250}}();Ext.air.Msg=Ext.air.MessageBox;Ext.USE_EXTENDED_LAYER=false;(function(){var a=Ext.air.App.getRootHtmlWindow(),b=0;window.nativeWindow.addEventListener("deactivate",function(){if(!Ext.air.App.getActiveWindow()&&Ext.air.XWindow&&!Ext.air.XWindow.getNative().closed){Ext.air.XWindow.hide()}});if(a!=window){window.Ext.air.XWindow=a.Ext.air.XWindow;return}if(!Ext.air.XWindow){Ext.air.XWindow=new Ext.air.NativeWindow({type:air.NativeWindowType.LIGHTWEIGHT,parent:a.nativeWindow,systemChrome:air.NativeWindowSystemChrome.NONE,transparent:true,complete:false,maximizable:false,resizable:false,minimizable:false,draggable:false,hidden:true,alwaysInFront:true,closeAction:"hide",fileQuery:{type:"queryExt",root:a.document,includeAllCSS:true},manager:{register:Ext.emptyFn,unregister:Ext.emptyFn},show:function(){b++;Ext.air.NativeWindow.prototype.show.apply(this,arguments)},hide:function(){b--;if(b<1){b=0;Ext.air.NativeWindow.prototype.hide.apply(this,arguments)}},listeners:{complete:function(f){var d=f.getDocument().body;d.scroll="no";d.style.overflow="hidden";f.fullscreen(true);f.complete=true}}})}Ext.apply(Ext.EventManager,{onDocumentReady:Ext.EventManager.onDocumentReady.createInterceptor(function(g,f,d){if(a.Ext.USE_EXTENDED_LAYER===true){if(a.Ext.air.XWindow.complete){a.Ext.air.XWindow.getWindow().Ext.EventManager.onDocumentReady(g,f||window,d)}else{a.Ext.air.XWindow.on("complete",function(h){h.getWindow().Ext.EventManager.onDocumentReady(g,f||window,d)},this,{single:true})}return false}})});Ext.onReady(function(){if(Ext.USE_EXTENDED_LAYER!==true&&Ext.air.XWindow){Ext.air.XWindow.close()}},a,{single:true});Ext.onReady=Ext.EventManager.onDocumentReady})();Ext.override(Ext.Layer,{anim:function(){return this},isVisible:function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){return Ext.air.XWindow.isVisible()&&this.visible}return this.visible},showAction:Ext.Layer.prototype.showAction.createInterceptor(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){var a=Ext.air.XWindow.getDocument();this.xParent=this.dom.parentNode;this.dom=a.adoptNode(this.dom,true);a.body.appendChild(this.dom);Ext.air.XWindow.show()}}),hideAction:Ext.Layer.prototype.hideAction.createInterceptor(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&this.xParent){this.dom=document.adoptNode(this.dom,true);this.xParent.appendChild(this.dom);Ext.air.XWindow.hide()}}),getX:function(){return this.getXY()[0]},getY:function(){return this.getXY()[1]},getXY:function(){var a=Ext.Element.prototype.getXY.call(this);if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){a[0]-=window.nativeWindow.x;a[1]-=window.nativeWindow.y}return a},setXY:function(i,f,j,k,h){var g=[i[0],i[1]];if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){g[0]+=window.nativeWindow.x;g[1]+=window.nativeWindow.y}this.fixDisplay();this.beforeAction();this.storeXY(g);var b=this.createCB(k);Ext.Element.prototype.setXY.call(this,g,f,j,b,h);if(!f){b()}return this},setLeftTop:function(b,a){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){b+=window.nativeWindow.x;a+=window.nativeWindow.y}this.storeLeftTop(b,a);Ext.Element.prototype.setLeftTop.apply(this,arguments);this.sync();return this},getTop:function(b){var a=Ext.Element.prototype.getTop.call(this,b);if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&b){a-=window.nativeWindow.y}return a},getLeft:function(b){var a=Ext.Element.prototype.getLeft.call(this,b);if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&b){a-=window.nativeWindow.x}return a},getPositioning:function(){var a=Ext.Element.prototype.getPositioning.call(this);if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){a[a.top?"top":"bottom"]-=window.nativeWindow.y;a[a.left?"left":"right"]-=window.nativeWindow.x}return a},constrainXY:function(){return this},setBounds:function(m,k,n,f,l,i,j,g){this.beforeAction();var b=this.createCB(j);if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){m+=window.nativeWindow.x;k+=window.nativeWindow.y}if(!l){this.storeXY([m,k]);Ext.Element.prototype.setXY.call(this,[m,k]);Ext.Element.prototype.setSize.call(this,n,f,l,i,b,g);b()}else{Ext.Element.prototype.setBounds.call(this,m,k,n,f,l,i,b,g)}return this},getBox:function(f,g){var d=Ext.Element.prototype.getBox.call(this,f,g),a=window.nativeWindow.x,h=window.nativeWindow.y;if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&g){d.x-=a;d[0]-=a;d.y-=h;d[1]-=h;d.right-=a;d.bottom-=h}return d},getRegion:function(){var b=Ext.Element.prototype.getRegion.call(this),a=window.nativeWindow.x,d=window.nativeWindow.y;if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){b.left-=a;b.right-=a;b[0]-=a;b.top-=d;b.bottom-=d;b[1]-=d}return b},setRegion:function(f,b){var d=f,a=window.nativeWindow.x,g=window.nativeWindow.y;if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){d=Ext.copyTo({},d,"left,right,top,bottom");d.left+=a;d.right+=a;d.top+=g;d.bottom+=g}return Ext.Element.prototype.setRegion.call(this,d,b)},translatePoints:function(k,j){j=isNaN(k[1])?j:k[1];k=isNaN(k[0])?k:k[0];var i=this,a=i.isStyle("position","relative"),b=i.getXY(),h=Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow,g=h?window.nativeWindow.x:0,f=h?window.nativeWindow.y:0,d=parseInt(i.getStyle("left"),10),m=parseInt(i.getStyle("top"),10);d=!isNaN(d)?d-g:(a?0:i.dom.offsetLeft-g);m=!isNaN(m)?m-f:(a?0:i.dom.offsetTop-f);return{left:(k-b[0]+d),top:(j-b[1]+m)}},getConstrainToXY:function(b,a,d,g){var f={top:0,left:0,bottom:0,right:0};return function(j,B,m,o){j=Ext.get(j);var A,E,z=0,v=0;m=m?Ext.applyIf(m,f):f;if(j.dom==document.body||j.dom==document){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){A=Ext.air.XWindow.getWidth();E=Ext.air.XWindow.getHeight()}else{A=Ext.lib.Dom.getViewWidth();E=Ext.lib.Dom.getViewHeight()}}else{A=j.dom.clientWidth;E=j.dom.clientHeight;if(!B){var u=j.getXY();z=u[0];v=u[1]}}var t=j.getScroll();z+=m.left+t.left;v+=m.top+t.top;A-=m.right;E-=m.bottom;var C=z+A,i=v+E,k=o||(!B?this.getXY():[this.getLeft(true),this.getTop(true)]),q=k[0],p=k[1],l=this.getConstrainOffset(),r=this.dom.offsetWidth+l,D=this.dom.offsetHeight+l;var n=false;if((q+r)>C){q=C-r;n=true}if((p+D)>i){p=i-D;n=true}if(q<z){q=z;n=true}if(p<v){p=v;n=true}return n?[q,p]:false}}(),getAlignToXY:function(f,v,x){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){v=(!v||v=="?"?"tl-bl?":(!(/-/).test(v)&&v!==""?"tl-"+v:v||"tl-bl")).toLowerCase();var y=v.match(/^([a-z]+)-([a-z]+)(\?)?$/),B=!!y[3],i,l,z,t,b,g,j,k,q,u,d="",a="",D=window.nativeWindow.x,C=window.nativeWindow.y,n=Ext.air.XWindow.getWidth(),A=Ext.air.XWindow.getHeight();if(B){v=v.substr(0,v.length-1);t=f.getRegion()}i=Ext.Element.prototype.getAlignToXY.call(this,f,v,x);if(f.dom&&f.dom.ownerDocument==Ext.air.XWindow.getDocument()){i[0]-=D;i[1]-=C;t.left-=D;t[0]-=D;t.right-=D;t.top-=C;t[1]-=C;t.bottom-=C}if(B){d=y[1],a=y[2],l=this.getWidth();z=this.getHeight();b=d.charAt(0);g=d.charAt(d.length-1);j=a.charAt(0);k=a.charAt(a.length-1);q=((b=="t"&&j=="b")||(b=="b"&&j=="t"));u=((g=="r"&&k=="l")||(g=="l"&&k=="r"));if(i[0]+l+D>n){i[0]=u?t.left-l:n-l}if(i[0]+D<0){i[0]=u?t.right:0}if(i[1]+z+C>A){i[1]=q?t.top-z:A-z}if(i[1]+C<0){i[1]=q?t.bottom:0}}return i}return Ext.Element.prototype.getAlignToXY.apply(this,arguments)},constrainXY:function(){if(true||this.constrain){var i=Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow,l=i?Ext.air.XWindow.getWidth():Ext.lib.Dom.getViewWidth(),f=i?Ext.air.XWindow.getHeight():Ext.lib.Dom.getViewHeight(),q=i?{left:0,top:0}:Ext.getDoc().getScroll(),d=i?window.nativeWindow.x:0,b=i?window.nativeWindow.y:0,p=this.getXY(),m=p[0],k=p[1],a=this.shadowOffset,n=this.dom.offsetWidth+a,g=this.dom.offsetHeight+a,j=false;if((m+n+d)>l+q.left){m=l-n-a-d;j=true}if((k+g+b)>f+q.top){k=f-g-a-b;j=true}if(m+d<q.left){m=q.left;j=true}if(k+b<q.top){k=q.top;j=true}if(j){if(this.avoidY){var o=this.avoidY;if(k<=o&&(k+g)>=o){k=o-g-5}}m+=d;k+=b;p=[m,k];this.storeXY(p);Ext.Element.prototype.setXY.call(this,p);this.sync()}}return this},sync:function(b){var p=this.shadow,k=Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow,n=k?window.nativeWindow.x:0,m=k?window.nativeWindow.y:0;if(!this.updating&&this.isVisible()&&(p||this.useShim)){var g=this.getShim(),o=this.getWidth(),i=this.getHeight(),d=this.getLeft(true)+n,q=this.getTop(true)+m;if(p&&!this.shadowDisabled){if(b&&!p.isVisible()){p.show(this)}else{p.realign(d,q,o,i)}if(g){if(b){g.show()}var j=p.el.getXY(),f=g.dom.style,a=p.el.getSize();f.left=(j[0])+"px";f.top=(j[1])+"px";f.width=(a.width)+"px";f.height=(a.height)+"px"}}else{if(g){if(b){g.show()}g.setSize(o,i);g.setLeftTop(d,q)}}}}});Ext.override(Ext.Shadow,{show:function(b){var a;if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&b instanceof Ext.Layer){a=Ext.air.XWindow.getWindow();b=Ext.get(b.dom)}else{a=window;b=Ext.get(b)}if(!this.el){this.el=a.Ext.Shadow.Pool.pull();if(this.el.dom.nextSibling!=b.dom){this.el.insertBefore(b)}}this.el.setStyle("z-index",this.zIndex||parseInt(b.getStyle("z-index"),10)-1);if(Ext.isIE){this.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius="+(this.offset)+")"}this.realign(b.getLeft(true),b.getTop(true),b.getWidth(),b.getHeight());this.el.dom.style.display="block"}});Ext.override(Ext.menu.Menu,{constrainScroll:function(j){var b,f=this.ul.setHeight("auto").getHeight(),a=j,i,g,h,d;if(this.floating){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){d=Ext.air.XWindow.getHeight();h=0}else{g=Ext.fly(this.el.dom.parentNode);h=g.getScroll().top;d=g.getViewSize().height}i=j-h;b=this.maxHeight?this.maxHeight:d-i;if(f>d){b=d;a=j-i}else{if(b<f){a=j-(f-b);b=f}}}else{b=this.getHeight()}if(this.maxHeight){b=Math.min(this.maxHeight,b)}if(f>b&&b>0){this.activeMax=b-this.scrollerHeight*2-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0);this.ul.setHeight(this.activeMax);this.createScrollers();this.el.select(".x-menu-scroller").setDisplayed("")}else{this.ul.setHeight(f);this.el.select(".x-menu-scroller").setDisplayed("none")}this.ul.dom.scrollTop=0;return a}});Ext.override(Ext.ColorPalette,{select:Ext.ColorPalette.prototype.select.createInterceptor(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&this.ownerCt instanceof Ext.menu.Menu){this.xEl=this.el;this.el=Ext.get(document.importNode(this.ownerCt.el.dom,true))}}).createSequence(function(){if(this.xEl){Ext.removeNode(this.el.dom);this.el=this.xEl}})});Ext.override(Ext.form.ComboBox,{restrictHeight:function(){this.innerList.dom.style.height="";var d=this.innerList.dom,k=Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow,i=this.list.getFrameWidth("tb")+(this.resizable?this.handleHeight:0)+this.assetHeight,f=Math.max(d.clientHeight,d.offsetHeight,d.scrollHeight),a=this.getPosition()[1]-Ext.getBody().getScroll().top+(k?Ext.air.XWindow.getPosition()[1]:0),b=k?Ext.air.XWindow.getHeight():Ext.lib.Dom.getViewHeight(),j=b-a-this.getSize().height,g=Math.max(a,j,this.minHeight||0)-this.list.shadowOffset-i-5;f=Math.min(f,g,this.maxHeight);this.innerList.setHeight(f);this.list.beginUpdate();this.list.setHeight(f+i);this.list.alignTo.apply(this.list,[this.el].concat(this.listAlign));this.list.endUpdate()},initEvents:Ext.form.ComboBox.prototype.initEvents.createSequence(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){this.on({expand:this.onExpandX,collapse:this.onCollapseX,scope:this})}}),onExpandX:function(){this.mon(Ext.air.XWindow.getWindow().Ext.getDoc(),{mousewheel:this.collapseIfX,mousedown:this.collapseIfX,scope:this})},onCollapseX:function(){var a=Ext.air.XWindow.getWindow().Ext.getDoc();this.mun(a,"mousewheel",this.collapseIfX,this);this.mun(a,"mousedown",this.collapseIfX,this)},collapseIfX:function(b){var a=b.within(this.list);if(!this.isDestroyed){if(!a){this.collapse()}else{window.nativeWindow.activate();this.el.focus()}}},collapseIf:function(a){if(!this.isDestroyed&&!a.within(this.wrap)){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow&&a.type=="mousewheel"){Ext.air.XWindow.setActive(true);this.list.focus()}else{if(!a.within(this.list)){this.collapse()}}}}});Ext.override(Ext.util.ClickRepeater,{handleMouseDown:Ext.util.ClickRepeater.prototype.handleMouseDown.createInterceptor(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){Ext.air.XWindow.getWindow().Ext.getDoc().on("mouseup",this.handleMouseUp,this)}}),handleMouseUp:Ext.util.ClickRepeater.prototype.handleMouseUp.createInterceptor(function(){if(Ext.USE_EXTENDED_LAYER===true&&Ext.air.XWindow){Ext.air.XWindow.getWindow().Ext.getDoc().un("mouseup",this.handleMouseUp,this)}})});